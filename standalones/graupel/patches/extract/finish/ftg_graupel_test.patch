--- eniac_a/src/tests/ftg_graupel_test.f90	2018-10-24 08:30:20.000000000 +0200
+++ eniac_b/src/tests/ftg_graupel_test.f90	2018-10-24 08:32:42.741909237 +0200
@@ -69,8 +69,6 @@
     REAL(KIND=wp), DIMENSION(:), ALLOCATABLE :: prr_gsp
     REAL(KIND=wp), DIMENSION(:), ALLOCATABLE :: prs_gsp
     REAL(KIND=wp), DIMENSION(:), ALLOCATABLE :: prg_gsp
-    REAL(KIND=wp), DIMENSION(:,:), ALLOCATABLE :: tinc_lh
-    REAL(KIND=wp), DIMENSION(:,:), ALLOCATABLE :: pstoph
     REAL(KIND=wp), DIMENSION(:,:), ALLOCATABLE :: qrsflux
     LOGICAL :: l_cv
     LOGICAL :: ldiag_ttend
@@ -109,7 +107,7 @@
     
     CALL ftg_graupel_init_for_replay('input')
     CALL ftg_graupel_replay_input(nvec, ke, ivstart, ivend, kstart, idbg, zdt, dz, t, p, rho, qv, qc, qi, qr, qs, qg, qnc, qi0, &
-    &  qc0, prr_gsp, prs_gsp, prg_gsp, tinc_lh, pstoph, qrsflux, l_cv, ldiag_ttend, ldiag_qtend, ddt_tend_t, ddt_tend_qv, &
+    &  qc0, prr_gsp, prs_gsp, prg_gsp, qrsflux, l_cv, ldiag_ttend, ldiag_qtend, ddt_tend_t, ddt_tend_qv, &
     &  ddt_tend_qc, ddt_tend_qi, ddt_tend_qr, ddt_tend_qs, ddt_diag_au, ddt_diag_ac, ddt_diag_ev, ddt_diag_nuc, ddt_diag_idep, &
     &  ddt_diag_sdep, ddt_diag_agg, ddt_diag_rim, ddt_diag_rcri, ddt_diag_icri, ddt_diag_dau, ddt_diag_iau, ddt_diag_imelt, &
     &  ddt_diag_smelt, ddt_diag_cfrz, ddt_diag_rfrz, ddt_diag_shed, ddt_tend_qg)
@@ -117,7 +115,7 @@
     
     CALL start_loc_timing("graupel", 1)
     CALL graupel(nvec, ke, ivstart, ivend, kstart, idbg, zdt, dz, t, p, rho, qv, qc, qi, qr, qs, qg, qnc, qi0, qc0, prr_gsp, &
-    &  prs_gsp, prg_gsp, tinc_lh, pstoph, qrsflux, l_cv, ldiag_ttend, ldiag_qtend, ddt_tend_t, ddt_tend_qv, ddt_tend_qc, &
+    &  prs_gsp, prg_gsp, qrsflux, l_cv, ldiag_ttend, ldiag_qtend, ddt_tend_t, ddt_tend_qv, ddt_tend_qc, &
     &  ddt_tend_qi, ddt_tend_qr, ddt_tend_qs, ddt_diag_au, ddt_diag_ac, ddt_diag_ev, ddt_diag_nuc, ddt_diag_idep, ddt_diag_sdep, &
     &  ddt_diag_agg, ddt_diag_rim, ddt_diag_rcri, ddt_diag_icri, ddt_diag_dau, ddt_diag_iau, ddt_diag_imelt, ddt_diag_smelt, &
     &  ddt_diag_cfrz, ddt_diag_rfrz, ddt_diag_shed, ddt_tend_qg)
@@ -146,7 +144,7 @@
   END SUBROUTINE ftg_graupel_init_for_replay
   
   SUBROUTINE ftg_graupel_replay_input(nvec, ke, ivstart, ivend, kstart, idbg, zdt, dz, t, p, rho, qv, qc, qi, qr, qs, qg, qnc, &
-  &  qi0, qc0, prr_gsp, prs_gsp, prg_gsp, tinc_lh, pstoph, qrsflux, l_cv, ldiag_ttend, ldiag_qtend, ddt_tend_t, ddt_tend_qv, &
+  &  qi0, qc0, prr_gsp, prs_gsp, prg_gsp, qrsflux, l_cv, ldiag_ttend, ldiag_qtend, ddt_tend_t, ddt_tend_qv, &
   &  ddt_tend_qc, ddt_tend_qi, ddt_tend_qr, ddt_tend_qs, ddt_diag_au, ddt_diag_ac, ddt_diag_ev, ddt_diag_nuc, ddt_diag_idep, &
   &  ddt_diag_sdep, ddt_diag_agg, ddt_diag_rim, ddt_diag_rcri, ddt_diag_icri, ddt_diag_dau, ddt_diag_iau, ddt_diag_imelt, &
   &  ddt_diag_smelt, ddt_diag_cfrz, ddt_diag_rfrz, ddt_diag_shed, ddt_tend_qg)
@@ -174,8 +172,6 @@
     REAL(KIND=wp), DIMENSION(:), ALLOCATABLE, INTENT(inout) :: prr_gsp
     REAL(KIND=wp), DIMENSION(:), ALLOCATABLE, INTENT(inout) :: prs_gsp
     REAL(KIND=wp), DIMENSION(:), ALLOCATABLE, INTENT(inout) :: prg_gsp
-    REAL(KIND=wp), DIMENSION(:,:), ALLOCATABLE, INTENT(inout) :: tinc_lh
-    REAL(KIND=wp), DIMENSION(:,:), ALLOCATABLE, INTENT(inout) :: pstoph
     REAL(KIND=wp), DIMENSION(:,:), ALLOCATABLE, INTENT(inout) :: qrsflux
     LOGICAL, INTENT(inout), OPTIONAL :: l_cv
     LOGICAL, INTENT(inout), OPTIONAL :: ldiag_ttend
@@ -223,75 +219,67 @@
     CALL ftg_read("ke", ke)
     CALL ftg_read("zdt", zdt)
     CALL ftg_allocate_and_read_allocatable("dz", dz, ftg_rperturb)
-    #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_dz)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_dz)
     !$ACC ENTER DATA COPYIN( dz )
-    #endif
+#endif
     CALL ftg_allocate_and_read_allocatable("t", t, ftg_rperturb)
-    #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_t)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_t)
     !$ACC ENTER DATA COPYIN( t )
-    #endif
+#endif
     CALL ftg_allocate_and_read_allocatable("p", p, ftg_rperturb)
-    #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_p)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_p)
     !$ACC ENTER DATA COPYIN( p )
-    #endif
+#endif
     CALL ftg_allocate_and_read_allocatable("rho", rho, ftg_rperturb)
-    #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_rho)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_rho)
     !$ACC ENTER DATA COPYIN( rho )
-    #endif
+#endif
     CALL ftg_allocate_and_read_allocatable("qv", qv, ftg_rperturb)
-    #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_qv)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_qv)
     !$ACC ENTER DATA COPYIN( qv )
-    #endif
+#endif
     CALL ftg_allocate_and_read_allocatable("qc", qc, ftg_rperturb)
-    #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_qc)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_qc)
     !$ACC ENTER DATA COPYIN( qc )
-    #endif
+#endif
     CALL ftg_allocate_and_read_allocatable("qi", qi, ftg_rperturb)
-    #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_qi)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_qi)
     !$ACC ENTER DATA COPYIN( qi )
-    #endif
+#endif
     CALL ftg_allocate_and_read_allocatable("qr", qr, ftg_rperturb)
-    #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_qr)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_qr)
     !$ACC ENTER DATA COPYIN( qr )
-    #endif
+#endif
     CALL ftg_allocate_and_read_allocatable("qs", qs, ftg_rperturb)
-    #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_qs)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_qs)
     !$ACC ENTER DATA COPYIN( qs )
-    #endif
+#endif
     CALL ftg_allocate_and_read_allocatable("qg", qg, ftg_rperturb)
-    #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_qg)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_qg)
     !$ACC ENTER DATA COPYIN( qg )
-    #endif
+#endif
     CALL ftg_allocate_and_read_allocatable("qnc", qnc, ftg_rperturb)
-    #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_qnc)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_qnc)
     !$ACC ENTER DATA COPYIN( qnc )
-    #endif
+#endif
     CALL ftg_read("qi0", qi0)
     CALL ftg_read("qc0", qc0)
     CALL ftg_allocate_and_read_allocatable("prr_gsp", prr_gsp, ftg_rperturb)
-    #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_prr_gsp)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_prr_gsp)
     !$ACC ENTER DATA COPYIN( prr_gsp )
-    #endif
+#endif
     CALL ftg_allocate_and_read_allocatable("prs_gsp", prs_gsp, ftg_rperturb)
-    #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_prs_gsp)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_prs_gsp)
     !$ACC ENTER DATA COPYIN( prs_gsp )
-    #endif
+#endif
     CALL ftg_allocate_and_read_allocatable("prg_gsp", prg_gsp, ftg_rperturb)
-    #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_prg_gsp)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_prg_gsp)
     !$ACC ENTER DATA COPYIN( prg_gsp )
-    #endif
-    CALL ftg_allocate_and_read_allocatable("tinc_lh", tinc_lh, ftg_rperturb)
-    #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_tinc_lh)
-    !$ACC ENTER DATA COPYIN( tinc_lh )
-    #endif
-    CALL ftg_allocate_and_read_allocatable("pstoph", pstoph, ftg_rperturb)
-    #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_pstoph)
-    !$ACC ENTER DATA COPYIN( pstoph )
-    #endif
+#endif
     CALL ftg_allocate_and_read_allocatable("qrsflux", qrsflux, ftg_rperturb)
-    #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_qrsflux)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_qrsflux)
     !$ACC ENTER DATA COPYIN( qrsflux )
-    #endif
+#endif
     
     ! OPTIONAL ARGUMENTS
     IF (PRESENT(ivstart)) THEN
@@ -317,147 +305,147 @@
     END IF
     IF (PRESENT(ddt_tend_t)) THEN
       CALL ftg_allocate_and_read_allocatable("ddt_tend_t", ddt_tend_t, ftg_rperturb)
-      #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_tend_t)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_tend_t)
       !$ACC ENTER DATA COPYIN( ddt_tend_t )
-      #endif
+#endif
     END IF
     IF (PRESENT(ddt_tend_qv)) THEN
       CALL ftg_allocate_and_read_allocatable("ddt_tend_qv", ddt_tend_qv, ftg_rperturb)
-      #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_tend_qv)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_tend_qv)
       !$ACC ENTER DATA COPYIN( ddt_tend_qv )
-      #endif
+#endif
     END IF
     IF (PRESENT(ddt_tend_qc)) THEN
       CALL ftg_allocate_and_read_allocatable("ddt_tend_qc", ddt_tend_qc, ftg_rperturb)
-      #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_tend_qc)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_tend_qc)
       !$ACC ENTER DATA COPYIN( ddt_tend_qc )
-      #endif
+#endif
     END IF
     IF (PRESENT(ddt_tend_qi)) THEN
       CALL ftg_allocate_and_read_allocatable("ddt_tend_qi", ddt_tend_qi, ftg_rperturb)
-      #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_tend_qi)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_tend_qi)
       !$ACC ENTER DATA COPYIN( ddt_tend_qi )
-      #endif
+#endif
     END IF
     IF (PRESENT(ddt_tend_qr)) THEN
       CALL ftg_allocate_and_read_allocatable("ddt_tend_qr", ddt_tend_qr, ftg_rperturb)
-      #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_tend_qr)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_tend_qr)
       !$ACC ENTER DATA COPYIN( ddt_tend_qr )
-      #endif
+#endif
     END IF
     IF (PRESENT(ddt_tend_qs)) THEN
       CALL ftg_allocate_and_read_allocatable("ddt_tend_qs", ddt_tend_qs, ftg_rperturb)
-      #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_tend_qs)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_tend_qs)
       !$ACC ENTER DATA COPYIN( ddt_tend_qs )
-      #endif
+#endif
     END IF
     IF (PRESENT(ddt_diag_au)) THEN
       CALL ftg_allocate_and_read_allocatable("ddt_diag_au", ddt_diag_au, ftg_rperturb)
-      #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_diag_au)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_diag_au)
       !$ACC ENTER DATA COPYIN( ddt_diag_au )
-      #endif
+#endif
     END IF
     IF (PRESENT(ddt_diag_ac)) THEN
       CALL ftg_allocate_and_read_allocatable("ddt_diag_ac", ddt_diag_ac, ftg_rperturb)
-      #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_diag_ac)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_diag_ac)
       !$ACC ENTER DATA COPYIN( ddt_diag_ac )
-      #endif
+#endif
     END IF
     IF (PRESENT(ddt_diag_ev)) THEN
       CALL ftg_allocate_and_read_allocatable("ddt_diag_ev", ddt_diag_ev, ftg_rperturb)
-      #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_diag_ev)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_diag_ev)
       !$ACC ENTER DATA COPYIN( ddt_diag_ev )
-      #endif
+#endif
     END IF
     IF (PRESENT(ddt_diag_nuc)) THEN
       CALL ftg_allocate_and_read_allocatable("ddt_diag_nuc", ddt_diag_nuc, ftg_rperturb)
-      #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_diag_nuc)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_diag_nuc)
       !$ACC ENTER DATA COPYIN( ddt_diag_nuc )
-      #endif
+#endif
     END IF
     IF (PRESENT(ddt_diag_idep)) THEN
       CALL ftg_allocate_and_read_allocatable("ddt_diag_idep", ddt_diag_idep, ftg_rperturb)
-      #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_diag_idep)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_diag_idep)
       !$ACC ENTER DATA COPYIN( ddt_diag_idep )
-      #endif
+#endif
     END IF
     IF (PRESENT(ddt_diag_sdep)) THEN
       CALL ftg_allocate_and_read_allocatable("ddt_diag_sdep", ddt_diag_sdep, ftg_rperturb)
-      #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_diag_sdep)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_diag_sdep)
       !$ACC ENTER DATA COPYIN( ddt_diag_sdep )
-      #endif
+#endif
     END IF
     IF (PRESENT(ddt_diag_agg)) THEN
       CALL ftg_allocate_and_read_allocatable("ddt_diag_agg", ddt_diag_agg, ftg_rperturb)
-      #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_diag_agg)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_diag_agg)
       !$ACC ENTER DATA COPYIN( ddt_diag_agg )
-      #endif
+#endif
     END IF
     IF (PRESENT(ddt_diag_rim)) THEN
       CALL ftg_allocate_and_read_allocatable("ddt_diag_rim", ddt_diag_rim, ftg_rperturb)
-      #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_diag_rim)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_diag_rim)
       !$ACC ENTER DATA COPYIN( ddt_diag_rim )
-      #endif
+#endif
     END IF
     IF (PRESENT(ddt_diag_rcri)) THEN
       CALL ftg_allocate_and_read_allocatable("ddt_diag_rcri", ddt_diag_rcri, ftg_rperturb)
-      #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_diag_rcri)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_diag_rcri)
       !$ACC ENTER DATA COPYIN( ddt_diag_rcri )
-      #endif
+#endif
     END IF
     IF (PRESENT(ddt_diag_icri)) THEN
       CALL ftg_allocate_and_read_allocatable("ddt_diag_icri", ddt_diag_icri, ftg_rperturb)
-      #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_diag_icri)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_diag_icri)
       !$ACC ENTER DATA COPYIN( ddt_diag_icri )
-      #endif
+#endif
     END IF
     IF (PRESENT(ddt_diag_dau)) THEN
       CALL ftg_allocate_and_read_allocatable("ddt_diag_dau", ddt_diag_dau, ftg_rperturb)
-      #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_diag_dau)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_diag_dau)
       !$ACC ENTER DATA COPYIN( ddt_diag_dau )
-      #endif
+#endif
     END IF
     IF (PRESENT(ddt_diag_iau)) THEN
       CALL ftg_allocate_and_read_allocatable("ddt_diag_iau", ddt_diag_iau, ftg_rperturb)
-      #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_diag_iau)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_diag_iau)
       !$ACC ENTER DATA COPYIN( ddt_diag_iau )
-      #endif
+#endif
     END IF
     IF (PRESENT(ddt_diag_imelt)) THEN
       CALL ftg_allocate_and_read_allocatable("ddt_diag_imelt", ddt_diag_imelt, ftg_rperturb)
-      #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_diag_imelt)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_diag_imelt)
       !$ACC ENTER DATA COPYIN( ddt_diag_imelt )
-      #endif
+#endif
     END IF
     IF (PRESENT(ddt_diag_smelt)) THEN
       CALL ftg_allocate_and_read_allocatable("ddt_diag_smelt", ddt_diag_smelt, ftg_rperturb)
-      #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_diag_smelt)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_diag_smelt)
       !$ACC ENTER DATA COPYIN( ddt_diag_smelt )
-      #endif
+#endif
     END IF
     IF (PRESENT(ddt_diag_cfrz)) THEN
       CALL ftg_allocate_and_read_allocatable("ddt_diag_cfrz", ddt_diag_cfrz, ftg_rperturb)
-      #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_diag_cfrz)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_diag_cfrz)
       !$ACC ENTER DATA COPYIN( ddt_diag_cfrz )
-      #endif
+#endif
     END IF
     IF (PRESENT(ddt_diag_rfrz)) THEN
       CALL ftg_allocate_and_read_allocatable("ddt_diag_rfrz", ddt_diag_rfrz, ftg_rperturb)
-      #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_diag_rfrz)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_diag_rfrz)
       !$ACC ENTER DATA COPYIN( ddt_diag_rfrz )
-      #endif
+#endif
     END IF
     IF (PRESENT(ddt_diag_shed)) THEN
       CALL ftg_allocate_and_read_allocatable("ddt_diag_shed", ddt_diag_shed, ftg_rperturb)
-      #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_diag_shed)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_diag_shed)
       !$ACC ENTER DATA COPYIN( ddt_diag_shed )
-      #endif
+#endif
     END IF
     IF (PRESENT(ddt_tend_qg)) THEN
       CALL ftg_allocate_and_read_allocatable("ddt_tend_qg", ddt_tend_qg, ftg_rperturb)
-      #if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_tend_qg)
+#if defined(FTG_ACC_COPYIN) && !defined(FTG_ACC_NOCOPYIN_ddt_tend_qg)
       !$ACC ENTER DATA COPYIN( ddt_tend_qg )
-      #endif
+#endif
     END IF
     
     ! TYPE MEMBERS
