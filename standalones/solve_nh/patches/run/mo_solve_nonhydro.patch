--- eniac_a/src/atm_dyn_iconam/mo_solve_nonhydro.f90	2018-10-31 16:34:52.230144170 +0100
+++ eniac_b/src/atm_dyn_iconam/mo_solve_nonhydro.f90	2018-10-31 16:34:40.633821813 +0100
@@ -96,6 +96,27 @@
   LOGICAL, PARAMETER ::  acc_validate = .TRUE.    ! Only .TRUE. during unit testing
 #endif
 
+
+  ! ================= BEGIN FORTRAN TEST GENERATOR (FTG) =======================
+  
+  LOGICAL :: ftg_solve_nh_capture_input_enabled = .TRUE.
+  LOGICAL :: ftg_solve_nh_capture_output_enabled = .TRUE.
+  INTEGER :: ftg_solve_nh_capture_round = 1
+  INTEGER :: ftg_solve_nh_round = 0
+  CHARACTER(len=1024) :: ftg_solve_nh_input_dir = &
+  '++FTGDATADIR++/data/input'
+  CHARACTER(len=1024) :: ftg_solve_nh_output_dir = &
+  '++FTGDATADIR++/data/output'
+  
+  PUBLIC :: ftg_solve_nh_capture_input_enabled, ftg_solve_nh_capture_output_enabled, ftg_solve_nh_capture_round, &
+  &  ftg_solve_nh_input_dir, ftg_solve_nh_output_dir
+  
+  
+  
+  
+  ! ================= END FORTRAN TEST GENERATOR (FTG) =========================
+  
+
   CONTAINS
 
 
@@ -261,6 +282,16 @@
       ! for igradp_method = 3
       iplev(:), ipeidx(:), ipeblk(:)
 
+  ! ================= BEGIN FORTRAN TEST GENERATOR (FTG) =======================
+  
+  ftg_solve_nh_round = ftg_solve_nh_round + 1
+  CALL ftg_solve_nh_capture_input(p_nh, p_patch, p_int, prep_adv, nnow, nnew, l_init, l_recompute, lsave_mflx, lprep_adv, &
+  &  lclean_mflx, idyn_timestep, jstep, l_bdy_nudge, dtime)
+  
+  ! ================= END FORTRAN TEST GENERATOR (FTG) =========================
+  
+
+
     !-------------------------------------------------------------------
     IF (use_dycore_barrier) THEN
       CALL timer_start(timer_barrier)
@@ -2977,8 +3008,3943 @@
     CALL btraj%destruct()
 #endif
 
+
+  ! ================= BEGIN FORTRAN TEST GENERATOR (FTG) =======================
+  
+  CALL ftg_solve_nh_capture_output(p_nh, p_patch, prep_adv)
+  
+  ! ================= END FORTRAN TEST GENERATOR (FTG) =========================
+  
+
   END SUBROUTINE solve_nh
 
+! ================= BEGIN FORTRAN TEST GENERATOR (FTG) =======================
+
+SUBROUTINE ftg_solve_nh_init_for_capture(stage, dir)
+  
+  USE mo_impl_constants, ONLY: MAX_CHAR_LENGTH
+  USE mo_mpi,            ONLY: get_my_mpi_all_id
+  USE m_ser_ftg,         ONLY: ftg_set_serializer, ftg_add_serializer_metainfo, ignore_bullshit_max_dim_size, &
+  &  ignore_bullshit_allow_negative_indices
+  
+  CHARACTER(*), INTENT(IN) :: stage, dir
+  
+  CHARACTER(len=MAX_CHAR_LENGTH) :: basename, mkdirerr
+  
+  WRITE (basename,'(a,a,a,i0)') 'ftg_solve_nh_', TRIM(stage), '_', get_my_mpi_all_id()
+  
+  WRITE (0,*) 'FTG INIT solve_nh '//TRIM(basename), get_my_mpi_all_id()
+  
+  mkdirerr = ''
+  !  CALL EXECUTE_COMMAND_LINE('mkdir -p '//TRIM(dir), cmdmsg=mkdirerr)
+  !  IF (TRIM(mkdirerr) /= '') THEN
+    !    WRITE (0,*) 'FTG INIT *** ERROR: ', TRIM(mkdirerr)
+    !  END IF
+    
+    ignore_bullshit_max_dim_size = 100000
+    ignore_bullshit_allow_negative_indices = .TRUE.
+    
+    CALL ftg_set_serializer(TRIM(dir), TRIM(basename), 'w')
+    CALL ftg_add_serializer_metainfo('subroutine', 'solve_nh')
+    CALL ftg_add_serializer_metainfo('stage', stage)
+    CALL ftg_add_serializer_metainfo('mpi_all_id', get_my_mpi_all_id())
+    
+  END SUBROUTINE ftg_solve_nh_init_for_capture
+  
+  LOGICAL FUNCTION ftg_solve_nh_capture_input_active()
+  
+  ftg_solve_nh_capture_input_active =       &
+  ftg_solve_nh_capture_input_enabled .AND.  &
+  ftg_solve_nh_round .EQ. ftg_solve_nh_capture_round
+  
+END FUNCTION ftg_solve_nh_capture_input_active
+
+SUBROUTINE ftg_solve_nh_capture_input(p_nh, p_patch, p_int, prep_adv, nnow, nnew, l_init, l_recompute, lsave_mflx, lprep_adv, &
+&  lclean_mflx, idyn_timestep, jstep, l_bdy_nudge, dtime)
+  
+  USE mtime,     ONLY: calendarType
+  USE mo_mpi,    ONLY: get_my_mpi_all_id
+  USE m_ser_ftg, ONLY: ftg_set_savepoint, ftg_write, ftg_register_only, ftg_destroy_savepoint, ftg_destroy_serializer
+  USE timing_tools, ONLY: start_loc_timing, end_loc_timing
+  
+  USE mo_dynamics_config, ONLY: mo_dynamics_config__idiv_method => idiv_method
+  USE mo_run_config, ONLY: mo_run_config__ltimer => ltimer, mo_run_config__timers_level => timers_level, mo_run_config__lvert_nest &
+  &  => lvert_nest
+  USE mo_initicon_config, ONLY: mo_initicon_config__is_iau_active => is_iau_active, mo_initicon_config__iau_wgt_dyn => iau_wgt_dyn
+  USE mo_interpol_config, ONLY: mo_interpol_config__lsq_high_ord => lsq_high_ord, mo_interpol_config__lsq_high_set => &
+  &  lsq_high_set, mo_interpol_config__nudge_max_coeff => nudge_max_coeff, t_lsq_set
+  USE mo_sync, ONLY: mo_sync__log_unit => log_unit, mo_sync__do_sync_checks => do_sync_checks
+  USE mo_init_vgrid, ONLY: mo_init_vgrid__nflatlev => nflatlev
+  USE mo_nonhydrostatic_config, ONLY: mo_nonhydrostatic_config__lextra_diffu => lextra_diffu, &
+  &  mo_nonhydrostatic_config__divdamp_type => divdamp_type, mo_nonhydrostatic_config__rayleigh_type => rayleigh_type, &
+  &  mo_nonhydrostatic_config__veladv_offctr => veladv_offctr, mo_nonhydrostatic_config__kstart_moist => kstart_moist, &
+  &  mo_nonhydrostatic_config__kstart_dd3d => kstart_dd3d, mo_nonhydrostatic_config__ndyn_substeps_var => ndyn_substeps_var, &
+  &  mo_nonhydrostatic_config__divdamp_order => divdamp_order, mo_nonhydrostatic_config__divdamp_fac_o2 => divdamp_fac_o2, &
+  &  mo_nonhydrostatic_config__lhdiff_rcf => lhdiff_rcf, mo_nonhydrostatic_config__igradp_method => igradp_method, &
+  &  mo_nonhydrostatic_config__itime_scheme => itime_scheme, mo_nonhydrostatic_config__divdamp_fac => divdamp_fac, &
+  &  mo_nonhydrostatic_config__rhotheta_offctr => rhotheta_offctr, mo_nonhydrostatic_config__l_open_ubc => l_open_ubc, &
+  &  mo_nonhydrostatic_config__iadv_rhotheta => iadv_rhotheta
+  USE mo_timer, ONLY: mo_timer__timer_solve_nh_cellcomp => timer_solve_nh_cellcomp, mo_timer__timer_solve_nh => timer_solve_nh, &
+  &  mo_timer__timer_solve_nh_vimpl => timer_solve_nh_vimpl, mo_timer__timer_icon_comm_wait => timer_icon_comm_wait, &
+  &  mo_timer__timer_icon_comm_fillrecv => timer_icon_comm_fillrecv, mo_timer__timer_solve_nh_edgecomp => timer_solve_nh_edgecomp, &
+  &  mo_timer__timer_solve_nh_veltend => timer_solve_nh_veltend, mo_timer__timer_icon_comm_fillsend => timer_icon_comm_fillsend, &
+  &  mo_timer__timer_solve_nh_vnupd => timer_solve_nh_vnupd, mo_timer__timer_icon_comm_ircv => timer_icon_comm_ircv, &
+  &  mo_timer__timer_back_traj => timer_back_traj, mo_timer__timer_barrier => timer_barrier, mo_timer__timer_solve_nh_exch => &
+  &  timer_solve_nh_exch, mo_timer__timer_icon_comm_sync => timer_icon_comm_sync, mo_timer__timer_icon_comm_barrier_2 => &
+  &  timer_icon_comm_barrier_2, mo_timer__timer_intp => timer_intp
+  USE mo_vertical_coord_table, ONLY: mo_vertical_coord_table__vct_a => vct_a
+  USE mo_advection_config, ONLY: mo_advection_config__zeta => zeta, mo_advection_config__wgt_zeta => wgt_zeta, &
+  &  mo_advection_config__eta => eta, mo_advection_config__advection_config => advection_config, mo_advection_config__wgt_eta => &
+  &  wgt_eta, mo_advection_config__shape_func => shape_func, t_advection_config
+  USE mo_icon_comm_lib, ONLY: mo_icon_comm_lib__active_send_buffers => active_send_buffers, mo_icon_comm_lib__comm_variable => &
+  &  comm_variable, mo_icon_comm_lib__log_file_id => log_file_id, mo_icon_comm_lib__my_work_communicator => my_work_communicator, &
+  &  mo_icon_comm_lib__comm_lib_is_initialized => comm_lib_is_initialized, mo_icon_comm_lib__max_send_buffer_size => &
+  &  max_send_buffer_size, mo_icon_comm_lib__recv_buffer => recv_buffer, mo_icon_comm_lib__send_procs_buffer => send_procs_buffer, &
+  &  mo_icon_comm_lib__this_is_mpi_sequential => this_is_mpi_sequential, mo_icon_comm_lib__active_comm_variables => &
+  &  active_comm_variables, mo_icon_comm_lib__send_buffer => send_buffer, mo_icon_comm_lib__max_active_comm_variables => &
+  &  max_active_comm_variables, mo_icon_comm_lib__buffer_comm_status => buffer_comm_status, &
+  &  mo_icon_comm_lib__grid_comm_pattern_list => grid_comm_pattern_list, mo_icon_comm_lib__recv_procs_buffer => recv_procs_buffer, &
+  &  mo_icon_comm_lib__active_recv_buffers => active_recv_buffers, t_comm_process_buffer, t_comm_variable_real, t_grid_comm_pattern
+  USE mo_vertical_grid, ONLY: mo_vertical_grid__nflat_gradp => nflat_gradp, mo_vertical_grid__nrdmax => nrdmax
+  USE mo_parallel_config, ONLY: mo_parallel_config__max_no_of_comm_variables => max_no_of_comm_variables, &
+  &  mo_parallel_config__itype_comm => itype_comm, mo_parallel_config__use_icon_comm => use_icon_comm, &
+  &  mo_parallel_config__sync_barrier_mode => sync_barrier_mode, mo_parallel_config__nproma => nproma, &
+  &  mo_parallel_config__icon_comm_method => icon_comm_method, mo_parallel_config__icon_comm_debug => icon_comm_debug, &
+  &  mo_parallel_config__l_log_checks => l_log_checks, mo_parallel_config__n_ghost_rows => n_ghost_rows, &
+  &  mo_parallel_config__use_dycore_barrier => use_dycore_barrier, mo_parallel_config__max_mpi_message_size => &
+  &  max_mpi_message_size, mo_parallel_config__p_test_run => p_test_run
+  USE mo_grid_config, ONLY: mo_grid_config__l_limited_area => l_limited_area
+  USE mo_gridref_config, ONLY: mo_gridref_config__grf_intmethod_e => grf_intmethod_e
+  USE mo_advection_utils, ONLY: mo_advection_utils__ptr_delp_mc_now => ptr_delp_mc_now, mo_advection_utils__ptr_delp_mc_new => &
+  &  ptr_delp_mc_new
+  
+  TYPE(t_nh_state), INTENT(in) :: p_nh
+  TYPE(t_patch), INTENT(in) :: p_patch
+  TYPE(t_int_state), INTENT(in) :: p_int
+  TYPE(t_prepare_adv), INTENT(in) :: prep_adv
+  INTEGER, INTENT(in) :: nnow
+  INTEGER, INTENT(in) :: nnew
+  LOGICAL, INTENT(in) :: l_init
+  LOGICAL, INTENT(in) :: l_recompute
+  LOGICAL, INTENT(in) :: lsave_mflx
+  LOGICAL, INTENT(in) :: lprep_adv
+  LOGICAL, INTENT(in) :: lclean_mflx
+  INTEGER, INTENT(in) :: idyn_timestep
+  INTEGER, INTENT(in) :: jstep
+  LOGICAL, INTENT(in) :: l_bdy_nudge
+  REAL(wp), INTENT(in) :: dtime
+  
+  INTEGER :: ftg_d1, ftg_d2, ftg_d3, ftg_d4
+  CHARACTER(len=256) :: ftg_c
+  
+  IF (ftg_solve_nh_capture_input_active()) THEN
+    CALL start_loc_timing("solve_nh: FTG capture input", 10)
+    
+    CALL ftg_solve_nh_init_for_capture('input', ftg_solve_nh_input_dir)
+    CALL ftg_set_savepoint('input')
+    
+    WRITE (0,*) 'FTG ROUND solve_nh ', ftg_solve_nh_round, get_my_mpi_all_id()
+    WRITE (0,*) 'FTG WRITE INPUT DATA solve_nh', get_my_mpi_all_id()
+    
+    ! MTIME CALENDAR TYPE --> Remove this line if mtime is not used
+    CALL ftg_write("ftg_mtime_calendar", calendarType())
+    
+    ! BASIC ARGUMENTS
+    CALL ftg_write("nnow", nnow)
+    CALL ftg_write("nnew", nnew)
+    CALL ftg_write("l_init", l_init)
+    CALL ftg_write("l_recompute", l_recompute)
+    CALL ftg_write("lsave_mflx", lsave_mflx)
+    CALL ftg_write("lprep_adv", lprep_adv)
+    CALL ftg_write("lclean_mflx", lclean_mflx)
+    CALL ftg_write("idyn_timestep", idyn_timestep)
+    CALL ftg_write("jstep", jstep)
+    CALL ftg_write("l_bdy_nudge", l_bdy_nudge)
+    CALL ftg_write("dtime", dtime)
+    
+    
+    ! OPTIONAL ARGUMENTS
+    
+    ! TYPE MEMBERS
+    CALL ftg_register_only("p_nh", "TYPE(t_nh_state)")
+    CALL ftg_register_only("p_nh%diag", "TYPE(t_nh_diag)")
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_ddt_exner_phy)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%ddt_exner_phy )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%ddt_exner_phy", p_nh%diag%ddt_exner_phy, LBOUND(p_nh%diag%ddt_exner_phy), UBOUND(p_nh%diag% &
+    &  ddt_exner_phy))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_ddt_vn_adv)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%ddt_vn_adv )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%ddt_vn_adv", p_nh%diag%ddt_vn_adv, LBOUND(p_nh%diag%ddt_vn_adv), UBOUND(p_nh%diag%ddt_vn_adv))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_ddt_vn_phy)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%ddt_vn_phy )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%ddt_vn_phy", p_nh%diag%ddt_vn_phy, LBOUND(p_nh%diag%ddt_vn_phy), UBOUND(p_nh%diag%ddt_vn_phy))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_ddt_w_adv)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%ddt_w_adv )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%ddt_w_adv", p_nh%diag%ddt_w_adv, LBOUND(p_nh%diag%ddt_w_adv), UBOUND(p_nh%diag%ddt_w_adv))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_dtheta_v_ic_int)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%dtheta_v_ic_int )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%dtheta_v_ic_int", p_nh%diag%dtheta_v_ic_int, LBOUND(p_nh%diag%dtheta_v_ic_int), UBOUND(p_nh%diag% &
+    &  dtheta_v_ic_int))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_dtheta_v_ic_ubc)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%dtheta_v_ic_ubc )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%dtheta_v_ic_ubc", p_nh%diag%dtheta_v_ic_ubc, LBOUND(p_nh%diag%dtheta_v_ic_ubc), UBOUND(p_nh%diag% &
+    &  dtheta_v_ic_ubc))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_dvn_ie_int)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%dvn_ie_int )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%dvn_ie_int", p_nh%diag%dvn_ie_int, LBOUND(p_nh%diag%dvn_ie_int), UBOUND(p_nh%diag%dvn_ie_int))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_dvn_ie_ubc)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%dvn_ie_ubc )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%dvn_ie_ubc", p_nh%diag%dvn_ie_ubc, LBOUND(p_nh%diag%dvn_ie_ubc), UBOUND(p_nh%diag%dvn_ie_ubc))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_dw_int)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%dw_int )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%dw_int", p_nh%diag%dw_int, LBOUND(p_nh%diag%dw_int), UBOUND(p_nh%diag%dw_int))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_dw_ubc)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%dw_ubc )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%dw_ubc", p_nh%diag%dw_ubc, LBOUND(p_nh%diag%dw_ubc), UBOUND(p_nh%diag%dw_ubc))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_exner_dyn_incr)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%exner_dyn_incr )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%exner_dyn_incr", p_nh%diag%exner_dyn_incr, LBOUND(p_nh%diag%exner_dyn_incr), UBOUND(p_nh%diag% &
+    &  exner_dyn_incr))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_exner_incr)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%exner_incr )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%exner_incr", p_nh%diag%exner_incr, LBOUND(p_nh%diag%exner_incr), UBOUND(p_nh%diag%exner_incr))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_exner_pr)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%exner_pr )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%exner_pr", p_nh%diag%exner_pr, LBOUND(p_nh%diag%exner_pr), UBOUND(p_nh%diag%exner_pr))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_grf_bdy_mflx)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%grf_bdy_mflx )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%grf_bdy_mflx", p_nh%diag%grf_bdy_mflx, LBOUND(p_nh%diag%grf_bdy_mflx), UBOUND(p_nh%diag%grf_bdy_mflx))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_grf_tend_mflx)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%grf_tend_mflx )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%grf_tend_mflx", p_nh%diag%grf_tend_mflx, LBOUND(p_nh%diag%grf_tend_mflx), UBOUND(p_nh%diag% &
+    &  grf_tend_mflx))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_grf_tend_rho)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%grf_tend_rho )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%grf_tend_rho", p_nh%diag%grf_tend_rho, LBOUND(p_nh%diag%grf_tend_rho), UBOUND(p_nh%diag%grf_tend_rho))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_grf_tend_thv)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%grf_tend_thv )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%grf_tend_thv", p_nh%diag%grf_tend_thv, LBOUND(p_nh%diag%grf_tend_thv), UBOUND(p_nh%diag%grf_tend_thv))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_grf_tend_vn)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%grf_tend_vn )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%grf_tend_vn", p_nh%diag%grf_tend_vn, LBOUND(p_nh%diag%grf_tend_vn), UBOUND(p_nh%diag%grf_tend_vn))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_grf_tend_w)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%grf_tend_w )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%grf_tend_w", p_nh%diag%grf_tend_w, LBOUND(p_nh%diag%grf_tend_w), UBOUND(p_nh%diag%grf_tend_w))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_mass_fl_e)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%mass_fl_e )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%mass_fl_e", p_nh%diag%mass_fl_e, LBOUND(p_nh%diag%mass_fl_e), UBOUND(p_nh%diag%mass_fl_e))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_mass_fl_e_sv)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%mass_fl_e_sv )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%mass_fl_e_sv", p_nh%diag%mass_fl_e_sv, LBOUND(p_nh%diag%mass_fl_e_sv), UBOUND(p_nh%diag%mass_fl_e_sv))
+    CALL ftg_write("p_nh%diag%max_vcfl_dyn", p_nh%diag%max_vcfl_dyn)
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_mflx_ic_int)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%mflx_ic_int )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%mflx_ic_int", p_nh%diag%mflx_ic_int, LBOUND(p_nh%diag%mflx_ic_int), UBOUND(p_nh%diag%mflx_ic_int))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_mflx_ic_ubc)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%mflx_ic_ubc )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%mflx_ic_ubc", p_nh%diag%mflx_ic_ubc, LBOUND(p_nh%diag%mflx_ic_ubc), UBOUND(p_nh%diag%mflx_ic_ubc))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_rho_ic)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%rho_ic )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%rho_ic", p_nh%diag%rho_ic, LBOUND(p_nh%diag%rho_ic), UBOUND(p_nh%diag%rho_ic))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_rho_incr)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%rho_incr )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%rho_incr", p_nh%diag%rho_incr, LBOUND(p_nh%diag%rho_incr), UBOUND(p_nh%diag%rho_incr))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_theta_v_ic)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%theta_v_ic )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%theta_v_ic", p_nh%diag%theta_v_ic, LBOUND(p_nh%diag%theta_v_ic), UBOUND(p_nh%diag%theta_v_ic))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_vn_ie)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%vn_ie )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%vn_ie", p_nh%diag%vn_ie, LBOUND(p_nh%diag%vn_ie), UBOUND(p_nh%diag%vn_ie))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_vn_incr)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%vn_incr )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%vn_incr", p_nh%diag%vn_incr, LBOUND(p_nh%diag%vn_incr), UBOUND(p_nh%diag%vn_incr))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_vt)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%vt )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%vt", p_nh%diag%vt, LBOUND(p_nh%diag%vt), UBOUND(p_nh%diag%vt))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_w_concorr_c)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%w_concorr_c )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%w_concorr_c", p_nh%diag%w_concorr_c, LBOUND(p_nh%diag%w_concorr_c), UBOUND(p_nh%diag%w_concorr_c))
+    CALL ftg_register_only("p_nh%metrics", "TYPE(t_nh_metrics)")
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_bdy_halo_c_blk)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%bdy_halo_c_blk )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%bdy_halo_c_blk", p_nh%metrics%bdy_halo_c_blk, LBOUND(p_nh%metrics%bdy_halo_c_blk), UBOUND(p_nh% &
+    &  metrics%bdy_halo_c_blk))
+    CALL ftg_write("p_nh%metrics%bdy_halo_c_dim", p_nh%metrics%bdy_halo_c_dim)
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_bdy_halo_c_idx)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%bdy_halo_c_idx )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%bdy_halo_c_idx", p_nh%metrics%bdy_halo_c_idx, LBOUND(p_nh%metrics%bdy_halo_c_idx), UBOUND(p_nh% &
+    &  metrics%bdy_halo_c_idx))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_bdy_mflx_e_blk)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%bdy_mflx_e_blk )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%bdy_mflx_e_blk", p_nh%metrics%bdy_mflx_e_blk, LBOUND(p_nh%metrics%bdy_mflx_e_blk), UBOUND(p_nh% &
+    &  metrics%bdy_mflx_e_blk))
+    CALL ftg_write("p_nh%metrics%bdy_mflx_e_dim", p_nh%metrics%bdy_mflx_e_dim)
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_bdy_mflx_e_idx)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%bdy_mflx_e_idx )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%bdy_mflx_e_idx", p_nh%metrics%bdy_mflx_e_idx, LBOUND(p_nh%metrics%bdy_mflx_e_idx), UBOUND(p_nh% &
+    &  metrics%bdy_mflx_e_idx))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_coeff1_dwdz)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%coeff1_dwdz )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%coeff1_dwdz", p_nh%metrics%coeff1_dwdz, LBOUND(p_nh%metrics%coeff1_dwdz), UBOUND(p_nh%metrics% &
+    &  coeff1_dwdz))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_coeff2_dwdz)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%coeff2_dwdz )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%coeff2_dwdz", p_nh%metrics%coeff2_dwdz, LBOUND(p_nh%metrics%coeff2_dwdz), UBOUND(p_nh%metrics% &
+    &  coeff2_dwdz))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_coeff_gradekin)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%coeff_gradekin )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%coeff_gradekin", p_nh%metrics%coeff_gradekin, LBOUND(p_nh%metrics%coeff_gradekin), UBOUND(p_nh% &
+    &  metrics%coeff_gradekin))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_coeff_gradp)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%coeff_gradp )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%coeff_gradp", p_nh%metrics%coeff_gradp, LBOUND(p_nh%metrics%coeff_gradp), UBOUND(p_nh%metrics% &
+    &  coeff_gradp))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_d_exner_dz_ref_ic)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%d_exner_dz_ref_ic )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%d_exner_dz_ref_ic", p_nh%metrics%d_exner_dz_ref_ic, LBOUND(p_nh%metrics%d_exner_dz_ref_ic), &
+    &  UBOUND(p_nh%metrics%d_exner_dz_ref_ic))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_ddqz_z_full_e)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%ddqz_z_full_e )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%ddqz_z_full_e", p_nh%metrics%ddqz_z_full_e, LBOUND(p_nh%metrics%ddqz_z_full_e), UBOUND(p_nh% &
+    &  metrics%ddqz_z_full_e))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_ddqz_z_half)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%ddqz_z_half )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%ddqz_z_half", p_nh%metrics%ddqz_z_half, LBOUND(p_nh%metrics%ddqz_z_half), UBOUND(p_nh%metrics% &
+    &  ddqz_z_half))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_ddxn_z_full)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%ddxn_z_full )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%ddxn_z_full", p_nh%metrics%ddxn_z_full, LBOUND(p_nh%metrics%ddxn_z_full), UBOUND(p_nh%metrics% &
+    &  ddxn_z_full))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_ddxt_z_full)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%ddxt_z_full )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%ddxt_z_full", p_nh%metrics%ddxt_z_full, LBOUND(p_nh%metrics%ddxt_z_full), UBOUND(p_nh%metrics% &
+    &  ddxt_z_full))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_exner_exfac)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%exner_exfac )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%exner_exfac", p_nh%metrics%exner_exfac, LBOUND(p_nh%metrics%exner_exfac), UBOUND(p_nh%metrics% &
+    &  exner_exfac))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_exner_ref_mc)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%exner_ref_mc )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%exner_ref_mc", p_nh%metrics%exner_ref_mc, LBOUND(p_nh%metrics%exner_ref_mc), UBOUND(p_nh%metrics% &
+    &  exner_ref_mc))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_hmask_dd3d)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%hmask_dd3d )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%hmask_dd3d", p_nh%metrics%hmask_dd3d, LBOUND(p_nh%metrics%hmask_dd3d), UBOUND(p_nh%metrics% &
+    &  hmask_dd3d))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_inv_ddqz_z_full)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%inv_ddqz_z_full )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%inv_ddqz_z_full", p_nh%metrics%inv_ddqz_z_full, LBOUND(p_nh%metrics%inv_ddqz_z_full), UBOUND( &
+    &  p_nh%metrics%inv_ddqz_z_full))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_mask_prog_halo_c)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%mask_prog_halo_c )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%mask_prog_halo_c", p_nh%metrics%mask_prog_halo_c, LBOUND(p_nh%metrics%mask_prog_halo_c), UBOUND( &
+    &  p_nh%metrics%mask_prog_halo_c))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_nudge_e_blk)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%nudge_e_blk )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%nudge_e_blk", p_nh%metrics%nudge_e_blk, LBOUND(p_nh%metrics%nudge_e_blk), UBOUND(p_nh%metrics% &
+    &  nudge_e_blk))
+    CALL ftg_write("p_nh%metrics%nudge_e_dim", p_nh%metrics%nudge_e_dim)
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_nudge_e_idx)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%nudge_e_idx )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%nudge_e_idx", p_nh%metrics%nudge_e_idx, LBOUND(p_nh%metrics%nudge_e_idx), UBOUND(p_nh%metrics% &
+    &  nudge_e_idx))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_pg_edgeblk)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%pg_edgeblk )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%pg_edgeblk", p_nh%metrics%pg_edgeblk, LBOUND(p_nh%metrics%pg_edgeblk), UBOUND(p_nh%metrics% &
+    &  pg_edgeblk))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_pg_edgeidx)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%pg_edgeidx )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%pg_edgeidx", p_nh%metrics%pg_edgeidx, LBOUND(p_nh%metrics%pg_edgeidx), UBOUND(p_nh%metrics% &
+    &  pg_edgeidx))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_pg_exdist)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%pg_exdist )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%pg_exdist", p_nh%metrics%pg_exdist, LBOUND(p_nh%metrics%pg_exdist), UBOUND(p_nh%metrics%pg_exdist))
+    CALL ftg_write("p_nh%metrics%pg_listdim", p_nh%metrics%pg_listdim)
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_pg_vertidx)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%pg_vertidx )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%pg_vertidx", p_nh%metrics%pg_vertidx, LBOUND(p_nh%metrics%pg_vertidx), UBOUND(p_nh%metrics% &
+    &  pg_vertidx))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_rayleigh_vn)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%rayleigh_vn )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%rayleigh_vn", p_nh%metrics%rayleigh_vn, LBOUND(p_nh%metrics%rayleigh_vn), UBOUND(p_nh%metrics% &
+    &  rayleigh_vn))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_rayleigh_w)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%rayleigh_w )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%rayleigh_w", p_nh%metrics%rayleigh_w, LBOUND(p_nh%metrics%rayleigh_w), UBOUND(p_nh%metrics% &
+    &  rayleigh_w))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_rho_ref_mc)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%rho_ref_mc )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%rho_ref_mc", p_nh%metrics%rho_ref_mc, LBOUND(p_nh%metrics%rho_ref_mc), UBOUND(p_nh%metrics% &
+    &  rho_ref_mc))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_rho_ref_me)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%rho_ref_me )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%rho_ref_me", p_nh%metrics%rho_ref_me, LBOUND(p_nh%metrics%rho_ref_me), UBOUND(p_nh%metrics% &
+    &  rho_ref_me))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_scalfac_dd3d)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%scalfac_dd3d )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%scalfac_dd3d", p_nh%metrics%scalfac_dd3d, LBOUND(p_nh%metrics%scalfac_dd3d), UBOUND(p_nh%metrics% &
+    &  scalfac_dd3d))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_theta_ref_ic)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%theta_ref_ic )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%theta_ref_ic", p_nh%metrics%theta_ref_ic, LBOUND(p_nh%metrics%theta_ref_ic), UBOUND(p_nh%metrics% &
+    &  theta_ref_ic))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_theta_ref_mc)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%theta_ref_mc )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%theta_ref_mc", p_nh%metrics%theta_ref_mc, LBOUND(p_nh%metrics%theta_ref_mc), UBOUND(p_nh%metrics% &
+    &  theta_ref_mc))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_theta_ref_me)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%theta_ref_me )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%theta_ref_me", p_nh%metrics%theta_ref_me, LBOUND(p_nh%metrics%theta_ref_me), UBOUND(p_nh%metrics% &
+    &  theta_ref_me))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_vertidx_gradp)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%vertidx_gradp )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%vertidx_gradp", p_nh%metrics%vertidx_gradp, LBOUND(p_nh%metrics%vertidx_gradp), UBOUND(p_nh% &
+    &  metrics%vertidx_gradp))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_vwind_expl_wgt)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%vwind_expl_wgt )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%vwind_expl_wgt", p_nh%metrics%vwind_expl_wgt, LBOUND(p_nh%metrics%vwind_expl_wgt), UBOUND(p_nh% &
+    &  metrics%vwind_expl_wgt))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_vwind_impl_wgt)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%vwind_impl_wgt )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%vwind_impl_wgt", p_nh%metrics%vwind_impl_wgt, LBOUND(p_nh%metrics%vwind_impl_wgt), UBOUND(p_nh% &
+    &  metrics%vwind_impl_wgt))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_wgtfac_c)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%wgtfac_c )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%wgtfac_c", p_nh%metrics%wgtfac_c, LBOUND(p_nh%metrics%wgtfac_c), UBOUND(p_nh%metrics%wgtfac_c))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_wgtfac_e)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%wgtfac_e )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%wgtfac_e", p_nh%metrics%wgtfac_e, LBOUND(p_nh%metrics%wgtfac_e), UBOUND(p_nh%metrics%wgtfac_e))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_wgtfacq1_c)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%wgtfacq1_c )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%wgtfacq1_c", p_nh%metrics%wgtfacq1_c, LBOUND(p_nh%metrics%wgtfacq1_c), UBOUND(p_nh%metrics% &
+    &  wgtfacq1_c))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_wgtfacq_c)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%wgtfacq_c )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%wgtfacq_c", p_nh%metrics%wgtfacq_c, LBOUND(p_nh%metrics%wgtfacq_c), UBOUND(p_nh%metrics%wgtfacq_c))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_wgtfacq_e)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%wgtfacq_e )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%wgtfacq_e", p_nh%metrics%wgtfacq_e, LBOUND(p_nh%metrics%wgtfacq_e), UBOUND(p_nh%metrics%wgtfacq_e))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_zdiff_gradp)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%zdiff_gradp )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%zdiff_gradp", p_nh%metrics%zdiff_gradp, LBOUND(p_nh%metrics%zdiff_gradp), UBOUND(p_nh%metrics% &
+    &  zdiff_gradp))
+    ftg_c = "p_nh%prog"
+    CALL ftg_register_only(ftg_c, "TYPE(t_nh_prog)", LBOUND(p_nh%prog), UBOUND(p_nh%prog))
+    IF (ALLOCATED(p_nh%prog)) THEN
+      DO ftg_d1 = LBOUND(p_nh%prog, 1), UBOUND(p_nh%prog, 1)
+        WRITE (ftg_c,'(A,I0,A)') 'p_nh%prog(', ftg_d1, ')%exner'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_8383c5)
+        ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+        !NOACC UPDATE HOST( p_nh%prog(ftg_d1)%exner )
+#endif
+        
+        
+        CALL ftg_write(ftg_c, p_nh%prog(ftg_d1)%exner, LBOUND(p_nh%prog(ftg_d1)%exner), UBOUND(p_nh%prog(ftg_d1)%exner))
+      END DO
+    END IF
+    IF (ALLOCATED(p_nh%prog)) THEN
+      DO ftg_d1 = LBOUND(p_nh%prog, 1), UBOUND(p_nh%prog, 1)
+        WRITE (ftg_c,'(A,I0,A)') 'p_nh%prog(', ftg_d1, ')%rho'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_f69926)
+        ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+        !NOACC UPDATE HOST( p_nh%prog(ftg_d1)%rho )
+#endif
+        
+        
+        CALL ftg_write(ftg_c, p_nh%prog(ftg_d1)%rho, LBOUND(p_nh%prog(ftg_d1)%rho), UBOUND(p_nh%prog(ftg_d1)%rho))
+      END DO
+    END IF
+    IF (ALLOCATED(p_nh%prog)) THEN
+      DO ftg_d1 = LBOUND(p_nh%prog, 1), UBOUND(p_nh%prog, 1)
+        WRITE (ftg_c,'(A,I0,A)') 'p_nh%prog(', ftg_d1, ')%theta_v'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_51bd83)
+        ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+        !NOACC UPDATE HOST( p_nh%prog(ftg_d1)%theta_v )
+#endif
+        
+        
+        CALL ftg_write(ftg_c, p_nh%prog(ftg_d1)%theta_v, LBOUND(p_nh%prog(ftg_d1)%theta_v), UBOUND(p_nh%prog(ftg_d1)%theta_v))
+      END DO
+    END IF
+    IF (ALLOCATED(p_nh%prog)) THEN
+      DO ftg_d1 = LBOUND(p_nh%prog, 1), UBOUND(p_nh%prog, 1)
+        WRITE (ftg_c,'(A,I0,A)') 'p_nh%prog(', ftg_d1, ')%vn'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_fe65ce)
+        ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+        !NOACC UPDATE HOST( p_nh%prog(ftg_d1)%vn )
+#endif
+        
+        
+        CALL ftg_write(ftg_c, p_nh%prog(ftg_d1)%vn, LBOUND(p_nh%prog(ftg_d1)%vn), UBOUND(p_nh%prog(ftg_d1)%vn))
+      END DO
+    END IF
+    IF (ALLOCATED(p_nh%prog)) THEN
+      DO ftg_d1 = LBOUND(p_nh%prog, 1), UBOUND(p_nh%prog, 1)
+        WRITE (ftg_c,'(A,I0,A)') 'p_nh%prog(', ftg_d1, ')%w'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_24b5f8)
+        ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+        !NOACC UPDATE HOST( p_nh%prog(ftg_d1)%w )
+#endif
+        
+        
+        CALL ftg_write(ftg_c, p_nh%prog(ftg_d1)%w, LBOUND(p_nh%prog(ftg_d1)%w), UBOUND(p_nh%prog(ftg_d1)%w))
+      END DO
+    END IF
+    CALL ftg_register_only("p_nh%ref", "TYPE(t_nh_ref)")
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_ref_vn_ref)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%ref%vn_ref )
+#endif
+    
+    
+    CALL ftg_write("p_nh%ref%vn_ref", p_nh%ref%vn_ref, LBOUND(p_nh%ref%vn_ref), UBOUND(p_nh%ref%vn_ref))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_ref_w_ref)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%ref%w_ref )
+#endif
+    
+    
+    CALL ftg_write("p_nh%ref%w_ref", p_nh%ref%w_ref, LBOUND(p_nh%ref%w_ref), UBOUND(p_nh%ref%w_ref))
+    CALL ftg_register_only("p_patch", "TYPE(t_patch)")
+    CALL ftg_write("p_patch%id", p_patch%id)
+    CALL ftg_write("p_patch%n_childdom", p_patch%n_childdom)
+    CALL ftg_write("p_patch%n_patch_cells", p_patch%n_patch_cells)
+    CALL ftg_write("p_patch%n_patch_cells_g", p_patch%n_patch_cells_g)
+    CALL ftg_write("p_patch%n_patch_edges", p_patch%n_patch_edges)
+    CALL ftg_write("p_patch%n_patch_edges_g", p_patch%n_patch_edges_g)
+    CALL ftg_write("p_patch%n_patch_verts", p_patch%n_patch_verts)
+    CALL ftg_write("p_patch%n_patch_verts_g", p_patch%n_patch_verts_g)
+    CALL ftg_write("p_patch%nblks_c", p_patch%nblks_c)
+    CALL ftg_write("p_patch%nblks_e", p_patch%nblks_e)
+    CALL ftg_write("p_patch%nblks_v", p_patch%nblks_v)
+    CALL ftg_write("p_patch%nlev", p_patch%nlev)
+    CALL ftg_write("p_patch%nlevp1", p_patch%nlevp1)
+    CALL ftg_write("p_patch%nshift", p_patch%nshift)
+    CALL ftg_write("p_patch%nshift_child", p_patch%nshift_child)
+    CALL ftg_write("p_patch%nshift_total", p_patch%nshift_total)
+    CALL ftg_write("p_patch%sync_cells_not_owned", p_patch%sync_cells_not_owned)
+    CALL ftg_write("p_patch%sync_edges_not_owned", p_patch%sync_edges_not_owned)
+    CALL ftg_register_only("p_patch%cells", "TYPE(t_grid_cells)")
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_cells_area)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%cells%area )
+#endif
+    
+    
+    CALL ftg_write("p_patch%cells%area", p_patch%cells%area, LBOUND(p_patch%cells%area), UBOUND(p_patch%cells%area))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_cells_edge_blk)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%cells%edge_blk )
+#endif
+    
+    
+    CALL ftg_write("p_patch%cells%edge_blk", p_patch%cells%edge_blk, LBOUND(p_patch%cells%edge_blk), UBOUND(p_patch%cells%edge_blk))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_cells_edge_idx)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%cells%edge_idx )
+#endif
+    
+    
+    CALL ftg_write("p_patch%cells%edge_idx", p_patch%cells%edge_idx, LBOUND(p_patch%cells%edge_idx), UBOUND(p_patch%cells%edge_idx))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_cells_end_blk)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%cells%end_blk )
+#endif
+    
+    
+    CALL ftg_write("p_patch%cells%end_blk", p_patch%cells%end_blk, LBOUND(p_patch%cells%end_blk), UBOUND(p_patch%cells%end_blk))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_cells_end_block)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%cells%end_block )
+#endif
+    
+    
+    CALL ftg_write("p_patch%cells%end_block", p_patch%cells%end_block, LBOUND(p_patch%cells%end_block), UBOUND(p_patch%cells% &
+    &  end_block))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_cells_end_index)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%cells%end_index )
+#endif
+    
+    
+    CALL ftg_write("p_patch%cells%end_index", p_patch%cells%end_index, LBOUND(p_patch%cells%end_index), UBOUND(p_patch%cells% &
+    &  end_index))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_cells_neighbor_blk)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%cells%neighbor_blk )
+#endif
+    
+    
+    CALL ftg_write("p_patch%cells%neighbor_blk", p_patch%cells%neighbor_blk, LBOUND(p_patch%cells%neighbor_blk), UBOUND(p_patch% &
+    &  cells%neighbor_blk))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_cells_neighbor_idx)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%cells%neighbor_idx )
+#endif
+    
+    
+    CALL ftg_write("p_patch%cells%neighbor_idx", p_patch%cells%neighbor_idx, LBOUND(p_patch%cells%neighbor_idx), UBOUND(p_patch% &
+    &  cells%neighbor_idx))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_cells_refin_ctrl)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%cells%refin_ctrl )
+#endif
+    
+    
+    CALL ftg_write("p_patch%cells%refin_ctrl", p_patch%cells%refin_ctrl, LBOUND(p_patch%cells%refin_ctrl), UBOUND(p_patch%cells% &
+    &  refin_ctrl))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_cells_start_blk)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%cells%start_blk )
+#endif
+    
+    
+    CALL ftg_write("p_patch%cells%start_blk", p_patch%cells%start_blk, LBOUND(p_patch%cells%start_blk), UBOUND(p_patch%cells% &
+    &  start_blk))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_cells_start_block)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%cells%start_block )
+#endif
+    
+    
+    CALL ftg_write("p_patch%cells%start_block", p_patch%cells%start_block, LBOUND(p_patch%cells%start_block), UBOUND(p_patch% &
+    &  cells%start_block))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_cells_start_index)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%cells%start_index )
+#endif
+    
+    
+    CALL ftg_write("p_patch%cells%start_index", p_patch%cells%start_index, LBOUND(p_patch%cells%start_index), UBOUND(p_patch% &
+    &  cells%start_index))
+    CALL ftg_register_only("p_patch%edges", "TYPE(t_grid_edges)")
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_area_edge)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%area_edge )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%area_edge", p_patch%edges%area_edge, LBOUND(p_patch%edges%area_edge), UBOUND(p_patch%edges% &
+    &  area_edge))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_cell_blk)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%cell_blk )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%cell_blk", p_patch%edges%cell_blk, LBOUND(p_patch%edges%cell_blk), UBOUND(p_patch%edges%cell_blk))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_cell_idx)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%cell_idx )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%cell_idx", p_patch%edges%cell_idx, LBOUND(p_patch%edges%cell_idx), UBOUND(p_patch%edges%cell_idx))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_edge_cell_length)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%edge_cell_length )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%edge_cell_length", p_patch%edges%edge_cell_length, LBOUND(p_patch%edges%edge_cell_length), &
+    &  UBOUND(p_patch%edges%edge_cell_length))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_end_blk)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%end_blk )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%end_blk", p_patch%edges%end_blk, LBOUND(p_patch%edges%end_blk), UBOUND(p_patch%edges%end_blk))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_end_block)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%end_block )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%end_block", p_patch%edges%end_block, LBOUND(p_patch%edges%end_block), UBOUND(p_patch%edges% &
+    &  end_block))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_end_index)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%end_index )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%end_index", p_patch%edges%end_index, LBOUND(p_patch%edges%end_index), UBOUND(p_patch%edges% &
+    &  end_index))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_f_e)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%f_e )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%f_e", p_patch%edges%f_e, LBOUND(p_patch%edges%f_e), UBOUND(p_patch%edges%f_e))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_inv_dual_edge_length)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%inv_dual_edge_length )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%inv_dual_edge_length", p_patch%edges%inv_dual_edge_length, LBOUND(p_patch%edges% &
+    &  inv_dual_edge_length), UBOUND(p_patch%edges%inv_dual_edge_length))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_inv_primal_edge_length)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%inv_primal_edge_length )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%inv_primal_edge_length", p_patch%edges%inv_primal_edge_length, LBOUND(p_patch%edges% &
+    &  inv_primal_edge_length), UBOUND(p_patch%edges%inv_primal_edge_length))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_quad_blk)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%quad_blk )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%quad_blk", p_patch%edges%quad_blk, LBOUND(p_patch%edges%quad_blk), UBOUND(p_patch%edges%quad_blk))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_quad_idx)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%quad_idx )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%quad_idx", p_patch%edges%quad_idx, LBOUND(p_patch%edges%quad_idx), UBOUND(p_patch%edges%quad_idx))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_refin_ctrl)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%refin_ctrl )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%refin_ctrl", p_patch%edges%refin_ctrl, LBOUND(p_patch%edges%refin_ctrl), UBOUND(p_patch%edges% &
+    &  refin_ctrl))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_start_blk)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%start_blk )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%start_blk", p_patch%edges%start_blk, LBOUND(p_patch%edges%start_blk), UBOUND(p_patch%edges% &
+    &  start_blk))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_start_block)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%start_block )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%start_block", p_patch%edges%start_block, LBOUND(p_patch%edges%start_block), UBOUND(p_patch% &
+    &  edges%start_block))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_start_index)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%start_index )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%start_index", p_patch%edges%start_index, LBOUND(p_patch%edges%start_index), UBOUND(p_patch% &
+    &  edges%start_index))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_tangent_orientation)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%tangent_orientation )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%tangent_orientation", p_patch%edges%tangent_orientation, LBOUND(p_patch%edges% &
+    &  tangent_orientation), UBOUND(p_patch%edges%tangent_orientation))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_vertex_blk)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%vertex_blk )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%vertex_blk", p_patch%edges%vertex_blk, LBOUND(p_patch%edges%vertex_blk), UBOUND(p_patch%edges% &
+    &  vertex_blk))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_vertex_idx)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%vertex_idx )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%vertex_idx", p_patch%edges%vertex_idx, LBOUND(p_patch%edges%vertex_idx), UBOUND(p_patch%edges% &
+    &  vertex_idx))
+    CALL ftg_register_only("p_patch%geometry_info", "TYPE(t_grid_geometry_info)")
+    CALL ftg_write("p_patch%geometry_info%cell_type", p_patch%geometry_info%cell_type)
+    CALL ftg_write("p_patch%geometry_info%mean_cell_area", p_patch%geometry_info%mean_cell_area)
+    CALL ftg_register_only("p_patch%verts", "TYPE(t_grid_vertices)")
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_verts_cell_blk)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%verts%cell_blk )
+#endif
+    
+    
+    CALL ftg_write("p_patch%verts%cell_blk", p_patch%verts%cell_blk, LBOUND(p_patch%verts%cell_blk), UBOUND(p_patch%verts%cell_blk))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_verts_cell_idx)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%verts%cell_idx )
+#endif
+    
+    
+    CALL ftg_write("p_patch%verts%cell_idx", p_patch%verts%cell_idx, LBOUND(p_patch%verts%cell_idx), UBOUND(p_patch%verts%cell_idx))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_verts_edge_blk)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%verts%edge_blk )
+#endif
+    
+    
+    CALL ftg_write("p_patch%verts%edge_blk", p_patch%verts%edge_blk, LBOUND(p_patch%verts%edge_blk), UBOUND(p_patch%verts%edge_blk))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_verts_edge_idx)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%verts%edge_idx )
+#endif
+    
+    
+    CALL ftg_write("p_patch%verts%edge_idx", p_patch%verts%edge_idx, LBOUND(p_patch%verts%edge_idx), UBOUND(p_patch%verts%edge_idx))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_verts_end_blk)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%verts%end_blk )
+#endif
+    
+    
+    CALL ftg_write("p_patch%verts%end_blk", p_patch%verts%end_blk, LBOUND(p_patch%verts%end_blk), UBOUND(p_patch%verts%end_blk))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_verts_end_block)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%verts%end_block )
+#endif
+    
+    
+    CALL ftg_write("p_patch%verts%end_block", p_patch%verts%end_block, LBOUND(p_patch%verts%end_block), UBOUND(p_patch%verts% &
+    &  end_block))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_verts_end_index)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%verts%end_index )
+#endif
+    
+    
+    CALL ftg_write("p_patch%verts%end_index", p_patch%verts%end_index, LBOUND(p_patch%verts%end_index), UBOUND(p_patch%verts% &
+    &  end_index))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_verts_start_blk)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%verts%start_blk )
+#endif
+    
+    
+    CALL ftg_write("p_patch%verts%start_blk", p_patch%verts%start_blk, LBOUND(p_patch%verts%start_blk), UBOUND(p_patch%verts% &
+    &  start_blk))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_verts_start_block)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%verts%start_block )
+#endif
+    
+    
+    CALL ftg_write("p_patch%verts%start_block", p_patch%verts%start_block, LBOUND(p_patch%verts%start_block), UBOUND(p_patch% &
+    &  verts%start_block))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_verts_start_index)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%verts%start_index )
+#endif
+    
+    
+    CALL ftg_write("p_patch%verts%start_index", p_patch%verts%start_index, LBOUND(p_patch%verts%start_index), UBOUND(p_patch% &
+    &  verts%start_index))
+    CALL ftg_register_only("p_patch%cells%decomp_info", "TYPE(t_grid_domain_decomp_info)")
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_cells_decomp_info_decomp_domain)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%cells%decomp_info%decomp_domain )
+#endif
+    
+    
+    CALL ftg_write("p_patch%cells%decomp_info%decomp_domain", p_patch%cells%decomp_info%decomp_domain, LBOUND(p_patch%cells% &
+    &  decomp_info%decomp_domain), UBOUND(p_patch%cells%decomp_info%decomp_domain))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_cells_decomp_info_glb_index)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%cells%decomp_info%glb_index )
+#endif
+    
+    
+    CALL ftg_write("p_patch%cells%decomp_info%glb_index", p_patch%cells%decomp_info%glb_index, LBOUND(p_patch%cells%decomp_info% &
+    &  glb_index), UBOUND(p_patch%cells%decomp_info%glb_index))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_cells_decomp_info_owner_mask)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%cells%decomp_info%owner_mask )
+#endif
+    
+    
+    CALL ftg_write("p_patch%cells%decomp_info%owner_mask", p_patch%cells%decomp_info%owner_mask, LBOUND(p_patch%cells%decomp_info% &
+    &  owner_mask), UBOUND(p_patch%cells%decomp_info%owner_mask))
+    CALL ftg_register_only("p_patch%edges%decomp_info", "TYPE(t_grid_domain_decomp_info)")
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_decomp_info_decomp_domain)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%decomp_info%decomp_domain )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%decomp_info%decomp_domain", p_patch%edges%decomp_info%decomp_domain, LBOUND(p_patch%edges% &
+    &  decomp_info%decomp_domain), UBOUND(p_patch%edges%decomp_info%decomp_domain))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_decomp_info_glb_index)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%decomp_info%glb_index )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%decomp_info%glb_index", p_patch%edges%decomp_info%glb_index, LBOUND(p_patch%edges%decomp_info% &
+    &  glb_index), UBOUND(p_patch%edges%decomp_info%glb_index))
+    IF (ALLOCATED(p_patch%edges%dual_normal_cell)) THEN
+      CALL ftg_register_only("p_patch%edges%dual_normal_cell", "TYPE(t_tangent_vectors)", LBOUND(p_patch%edges%dual_normal_cell), &
+      &  UBOUND(p_patch%edges%dual_normal_cell))
+    END IF
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_dual_normal_cell_v1)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%dual_normal_cell%v1 )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%dual_normal_cell%v1", p_patch%edges%dual_normal_cell%v1, LBOUND(p_patch%edges%dual_normal_cell% &
+    &  v1), UBOUND(p_patch%edges%dual_normal_cell%v1))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_dual_normal_cell_v2)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%dual_normal_cell%v2 )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%dual_normal_cell%v2", p_patch%edges%dual_normal_cell%v2, LBOUND(p_patch%edges%dual_normal_cell% &
+    &  v2), UBOUND(p_patch%edges%dual_normal_cell%v2))
+    IF (ALLOCATED(p_patch%edges%primal_normal_cell)) THEN
+      CALL ftg_register_only("p_patch%edges%primal_normal_cell", "TYPE(t_tangent_vectors)", LBOUND(p_patch%edges% &
+      &  primal_normal_cell), UBOUND(p_patch%edges%primal_normal_cell))
+    END IF
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_primal_normal_cell_v1)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%primal_normal_cell%v1 )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%primal_normal_cell%v1", p_patch%edges%primal_normal_cell%v1, LBOUND(p_patch%edges% &
+    &  primal_normal_cell%v1), UBOUND(p_patch%edges%primal_normal_cell%v1))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_primal_normal_cell_v2)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%primal_normal_cell%v2 )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%primal_normal_cell%v2", p_patch%edges%primal_normal_cell%v2, LBOUND(p_patch%edges% &
+    &  primal_normal_cell%v2), UBOUND(p_patch%edges%primal_normal_cell%v2))
+    CALL ftg_register_only("p_patch%verts%decomp_info", "TYPE(t_grid_domain_decomp_info)")
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_verts_decomp_info_decomp_domain)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%verts%decomp_info%decomp_domain )
+#endif
+    
+    
+    CALL ftg_write("p_patch%verts%decomp_info%decomp_domain", p_patch%verts%decomp_info%decomp_domain, LBOUND(p_patch%verts% &
+    &  decomp_info%decomp_domain), UBOUND(p_patch%verts%decomp_info%decomp_domain))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_verts_decomp_info_glb_index)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%verts%decomp_info%glb_index )
+#endif
+    
+    
+    CALL ftg_write("p_patch%verts%decomp_info%glb_index", p_patch%verts%decomp_info%glb_index, LBOUND(p_patch%verts%decomp_info% &
+    &  glb_index), UBOUND(p_patch%verts%decomp_info%glb_index))
+    CALL ftg_register_only("p_int", "TYPE(t_int_state)")
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_int_c_bln_avg)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_int%c_bln_avg )
+#endif
+    
+    
+    CALL ftg_write("p_int%c_bln_avg", p_int%c_bln_avg, LBOUND(p_int%c_bln_avg), UBOUND(p_int%c_bln_avg))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_int_c_lin_e)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_int%c_lin_e )
+#endif
+    
+    
+    CALL ftg_write("p_int%c_lin_e", p_int%c_lin_e, LBOUND(p_int%c_lin_e), UBOUND(p_int%c_lin_e))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_int_cells_aw_verts)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_int%cells_aw_verts )
+#endif
+    
+    
+    CALL ftg_write("p_int%cells_aw_verts", p_int%cells_aw_verts, LBOUND(p_int%cells_aw_verts), UBOUND(p_int%cells_aw_verts))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_int_e_bln_c_s)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_int%e_bln_c_s )
+#endif
+    
+    
+    CALL ftg_write("p_int%e_bln_c_s", p_int%e_bln_c_s, LBOUND(p_int%e_bln_c_s), UBOUND(p_int%e_bln_c_s))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_int_e_flx_avg)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_int%e_flx_avg )
+#endif
+    
+    
+    CALL ftg_write("p_int%e_flx_avg", p_int%e_flx_avg, LBOUND(p_int%e_flx_avg), UBOUND(p_int%e_flx_avg))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_int_geofac_div)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_int%geofac_div )
+#endif
+    
+    
+    CALL ftg_write("p_int%geofac_div", p_int%geofac_div, LBOUND(p_int%geofac_div), UBOUND(p_int%geofac_div))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_int_geofac_grdiv)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_int%geofac_grdiv )
+#endif
+    
+    
+    CALL ftg_write("p_int%geofac_grdiv", p_int%geofac_grdiv, LBOUND(p_int%geofac_grdiv), UBOUND(p_int%geofac_grdiv))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_int_geofac_grg)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_int%geofac_grg )
+#endif
+    
+    
+    CALL ftg_write("p_int%geofac_grg", p_int%geofac_grg, LBOUND(p_int%geofac_grg), UBOUND(p_int%geofac_grg))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_int_geofac_n2s)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_int%geofac_n2s )
+#endif
+    
+    
+    CALL ftg_write("p_int%geofac_n2s", p_int%geofac_n2s, LBOUND(p_int%geofac_n2s), UBOUND(p_int%geofac_n2s))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_int_geofac_rot)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_int%geofac_rot )
+#endif
+    
+    
+    CALL ftg_write("p_int%geofac_rot", p_int%geofac_rot, LBOUND(p_int%geofac_rot), UBOUND(p_int%geofac_rot))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_int_nudgecoeff_e)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_int%nudgecoeff_e )
+#endif
+    
+    
+    CALL ftg_write("p_int%nudgecoeff_e", p_int%nudgecoeff_e, LBOUND(p_int%nudgecoeff_e), UBOUND(p_int%nudgecoeff_e))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_int_pos_on_tplane_e)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_int%pos_on_tplane_e )
+#endif
+    
+    
+    CALL ftg_write("p_int%pos_on_tplane_e", p_int%pos_on_tplane_e, LBOUND(p_int%pos_on_tplane_e), UBOUND(p_int%pos_on_tplane_e))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_int_rbf_vec_coeff_e)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_int%rbf_vec_coeff_e )
+#endif
+    
+    
+    CALL ftg_write("p_int%rbf_vec_coeff_e", p_int%rbf_vec_coeff_e, LBOUND(p_int%rbf_vec_coeff_e), UBOUND(p_int%rbf_vec_coeff_e))
+    CALL ftg_register_only("p_int%lsq_high", "TYPE(t_lsq)")
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_int_lsq_high_lsq_blk_c)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_int%lsq_high%lsq_blk_c )
+#endif
+    
+    
+    CALL ftg_write("p_int%lsq_high%lsq_blk_c", p_int%lsq_high%lsq_blk_c, LBOUND(p_int%lsq_high%lsq_blk_c), UBOUND(p_int%lsq_high% &
+    &  lsq_blk_c))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_int_lsq_high_lsq_idx_c)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_int%lsq_high%lsq_idx_c )
+#endif
+    
+    
+    CALL ftg_write("p_int%lsq_high%lsq_idx_c", p_int%lsq_high%lsq_idx_c, LBOUND(p_int%lsq_high%lsq_idx_c), UBOUND(p_int%lsq_high% &
+    &  lsq_idx_c))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_int_lsq_high_lsq_moments)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_int%lsq_high%lsq_moments )
+#endif
+    
+    
+    CALL ftg_write("p_int%lsq_high%lsq_moments", p_int%lsq_high%lsq_moments, LBOUND(p_int%lsq_high%lsq_moments), UBOUND(p_int% &
+    &  lsq_high%lsq_moments))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_int_lsq_high_lsq_pseudoinv)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_int%lsq_high%lsq_pseudoinv )
+#endif
+    
+    
+    CALL ftg_write("p_int%lsq_high%lsq_pseudoinv", p_int%lsq_high%lsq_pseudoinv, LBOUND(p_int%lsq_high%lsq_pseudoinv), UBOUND( &
+    &  p_int%lsq_high%lsq_pseudoinv))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_int_lsq_high_lsq_qtmat_c)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_int%lsq_high%lsq_qtmat_c )
+#endif
+    
+    
+    CALL ftg_write("p_int%lsq_high%lsq_qtmat_c", p_int%lsq_high%lsq_qtmat_c, LBOUND(p_int%lsq_high%lsq_qtmat_c), UBOUND(p_int% &
+    &  lsq_high%lsq_qtmat_c))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_int_lsq_high_lsq_rmat_rdiag_c)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_int%lsq_high%lsq_rmat_rdiag_c )
+#endif
+    
+    
+    CALL ftg_write("p_int%lsq_high%lsq_rmat_rdiag_c", p_int%lsq_high%lsq_rmat_rdiag_c, LBOUND(p_int%lsq_high%lsq_rmat_rdiag_c), &
+    &  UBOUND(p_int%lsq_high%lsq_rmat_rdiag_c))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_int_lsq_high_lsq_rmat_utri_c)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_int%lsq_high%lsq_rmat_utri_c )
+#endif
+    
+    
+    CALL ftg_write("p_int%lsq_high%lsq_rmat_utri_c", p_int%lsq_high%lsq_rmat_utri_c, LBOUND(p_int%lsq_high%lsq_rmat_utri_c), &
+    &  UBOUND(p_int%lsq_high%lsq_rmat_utri_c))
+    CALL ftg_register_only("prep_adv", "TYPE(t_prepare_adv)")
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_prep_adv_mass_flx_ic)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( prep_adv%mass_flx_ic )
+#endif
+    
+    
+    CALL ftg_write("prep_adv%mass_flx_ic", prep_adv%mass_flx_ic, LBOUND(prep_adv%mass_flx_ic), UBOUND(prep_adv%mass_flx_ic))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_prep_adv_mass_flx_me)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( prep_adv%mass_flx_me )
+#endif
+    
+    
+    CALL ftg_write("prep_adv%mass_flx_me", prep_adv%mass_flx_me, LBOUND(prep_adv%mass_flx_me), UBOUND(prep_adv%mass_flx_me))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_prep_adv_vn_traj)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( prep_adv%vn_traj )
+#endif
+    
+    
+    CALL ftg_write("prep_adv%vn_traj", prep_adv%vn_traj, LBOUND(prep_adv%vn_traj), UBOUND(prep_adv%vn_traj))
+    
+    
+    ! GLOBALS
+    CALL ftg_write("mo_icon_comm_lib__active_comm_variables", mo_icon_comm_lib__active_comm_variables)
+    CALL ftg_write("mo_icon_comm_lib__active_recv_buffers", mo_icon_comm_lib__active_recv_buffers)
+    CALL ftg_write("mo_icon_comm_lib__active_send_buffers", mo_icon_comm_lib__active_send_buffers)
+    CALL ftg_write("mo_icon_comm_lib__buffer_comm_status", mo_icon_comm_lib__buffer_comm_status)
+    CALL ftg_write("mo_icon_comm_lib__comm_lib_is_initialized", mo_icon_comm_lib__comm_lib_is_initialized)
+    CALL ftg_write("mo_nonhydrostatic_config__divdamp_fac", mo_nonhydrostatic_config__divdamp_fac)
+    CALL ftg_write("mo_nonhydrostatic_config__divdamp_fac_o2", mo_nonhydrostatic_config__divdamp_fac_o2)
+    CALL ftg_write("mo_nonhydrostatic_config__divdamp_order", mo_nonhydrostatic_config__divdamp_order)
+    CALL ftg_write("mo_nonhydrostatic_config__divdamp_type", mo_nonhydrostatic_config__divdamp_type)
+    CALL ftg_write("mo_sync__do_sync_checks", mo_sync__do_sync_checks)
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_advection_config__eta)
+    !$ACC UPDATE HOST( mo_advection_config__eta )
+#endif
+    
+    CALL ftg_write("mo_advection_config__eta", mo_advection_config__eta, LBOUND(mo_advection_config__eta), UBOUND( &
+    &  mo_advection_config__eta))
+    CALL ftg_write("mo_gridref_config__grf_intmethod_e", mo_gridref_config__grf_intmethod_e)
+    CALL ftg_write("mo_nonhydrostatic_config__iadv_rhotheta", mo_nonhydrostatic_config__iadv_rhotheta)
+    CALL ftg_write("mo_initicon_config__iau_wgt_dyn", mo_initicon_config__iau_wgt_dyn)
+    CALL ftg_write("mo_parallel_config__icon_comm_debug", mo_parallel_config__icon_comm_debug)
+    CALL ftg_write("mo_parallel_config__icon_comm_method", mo_parallel_config__icon_comm_method)
+    CALL ftg_write("mo_dynamics_config__idiv_method", mo_dynamics_config__idiv_method)
+    CALL ftg_write("mo_nonhydrostatic_config__igradp_method", mo_nonhydrostatic_config__igradp_method)
+    CALL ftg_write("mo_initicon_config__is_iau_active", mo_initicon_config__is_iau_active)
+    CALL ftg_write("mo_nonhydrostatic_config__itime_scheme", mo_nonhydrostatic_config__itime_scheme)
+    CALL ftg_write("mo_parallel_config__itype_comm", mo_parallel_config__itype_comm)
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_nonhydrostatic_config__kstart_dd3d)
+    !$ACC UPDATE HOST( mo_nonhydrostatic_config__kstart_dd3d )
+#endif
+    
+    CALL ftg_write("mo_nonhydrostatic_config__kstart_dd3d", mo_nonhydrostatic_config__kstart_dd3d, LBOUND( &
+    &  mo_nonhydrostatic_config__kstart_dd3d), UBOUND(mo_nonhydrostatic_config__kstart_dd3d))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_nonhydrostatic_config__kstart_moist)
+    !$ACC UPDATE HOST( mo_nonhydrostatic_config__kstart_moist )
+#endif
+    
+    CALL ftg_write("mo_nonhydrostatic_config__kstart_moist", mo_nonhydrostatic_config__kstart_moist, LBOUND( &
+    &  mo_nonhydrostatic_config__kstart_moist), UBOUND(mo_nonhydrostatic_config__kstart_moist))
+    CALL ftg_write("mo_grid_config__l_limited_area", mo_grid_config__l_limited_area)
+    CALL ftg_write("mo_parallel_config__l_log_checks", mo_parallel_config__l_log_checks)
+    CALL ftg_write("mo_nonhydrostatic_config__l_open_ubc", mo_nonhydrostatic_config__l_open_ubc)
+    CALL ftg_write("mo_nonhydrostatic_config__lextra_diffu", mo_nonhydrostatic_config__lextra_diffu)
+    CALL ftg_write("mo_nonhydrostatic_config__lhdiff_rcf", mo_nonhydrostatic_config__lhdiff_rcf)
+    CALL ftg_write("mo_icon_comm_lib__log_file_id", mo_icon_comm_lib__log_file_id)
+    CALL ftg_write("mo_sync__log_unit", mo_sync__log_unit)
+    CALL ftg_write("mo_interpol_config__lsq_high_ord", mo_interpol_config__lsq_high_ord)
+    CALL ftg_write("mo_run_config__ltimer", mo_run_config__ltimer)
+    CALL ftg_write("mo_run_config__lvert_nest", mo_run_config__lvert_nest)
+    CALL ftg_write("mo_icon_comm_lib__max_active_comm_variables", mo_icon_comm_lib__max_active_comm_variables)
+    CALL ftg_write("mo_parallel_config__max_mpi_message_size", mo_parallel_config__max_mpi_message_size)
+    CALL ftg_write("mo_parallel_config__max_no_of_comm_variables", mo_parallel_config__max_no_of_comm_variables)
+    CALL ftg_write("mo_icon_comm_lib__max_send_buffer_size", mo_icon_comm_lib__max_send_buffer_size)
+    CALL ftg_write("mo_icon_comm_lib__my_work_communicator", mo_icon_comm_lib__my_work_communicator)
+    CALL ftg_write("mo_parallel_config__n_ghost_rows", mo_parallel_config__n_ghost_rows)
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_nonhydrostatic_config__ndyn_substeps_var)
+    !$ACC UPDATE HOST( mo_nonhydrostatic_config__ndyn_substeps_var )
+#endif
+    
+    CALL ftg_write("mo_nonhydrostatic_config__ndyn_substeps_var", mo_nonhydrostatic_config__ndyn_substeps_var, LBOUND( &
+    &  mo_nonhydrostatic_config__ndyn_substeps_var), UBOUND(mo_nonhydrostatic_config__ndyn_substeps_var))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_vertical_grid__nflat_gradp)
+    !$ACC UPDATE HOST( mo_vertical_grid__nflat_gradp )
+#endif
+    
+    CALL ftg_write("mo_vertical_grid__nflat_gradp", mo_vertical_grid__nflat_gradp, LBOUND(mo_vertical_grid__nflat_gradp), UBOUND( &
+    &  mo_vertical_grid__nflat_gradp))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_init_vgrid__nflatlev)
+    !$ACC UPDATE HOST( mo_init_vgrid__nflatlev )
+#endif
+    
+    CALL ftg_write("mo_init_vgrid__nflatlev", mo_init_vgrid__nflatlev, LBOUND(mo_init_vgrid__nflatlev), UBOUND( &
+    &  mo_init_vgrid__nflatlev))
+    CALL ftg_write("mo_parallel_config__nproma", mo_parallel_config__nproma)
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_vertical_grid__nrdmax)
+    !$ACC UPDATE HOST( mo_vertical_grid__nrdmax )
+#endif
+    
+    CALL ftg_write("mo_vertical_grid__nrdmax", mo_vertical_grid__nrdmax, LBOUND(mo_vertical_grid__nrdmax), UBOUND( &
+    &  mo_vertical_grid__nrdmax))
+    CALL ftg_write("mo_interpol_config__nudge_max_coeff", mo_interpol_config__nudge_max_coeff)
+    CALL ftg_write("mo_parallel_config__p_test_run", mo_parallel_config__p_test_run)
+    IF (ASSOCIATED(mo_advection_utils__ptr_delp_mc_new)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_advection_utils__ptr_delp_mc_new)
+      !$ACC UPDATE HOST( mo_advection_utils__ptr_delp_mc_new )
+#endif
+      
+      CALL ftg_write("mo_advection_utils__ptr_delp_mc_new", mo_advection_utils__ptr_delp_mc_new, LBOUND( &
+      &  mo_advection_utils__ptr_delp_mc_new), UBOUND(mo_advection_utils__ptr_delp_mc_new))
+    END IF
+    IF (ASSOCIATED(mo_advection_utils__ptr_delp_mc_now)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_advection_utils__ptr_delp_mc_now)
+      !$ACC UPDATE HOST( mo_advection_utils__ptr_delp_mc_now )
+#endif
+      
+      CALL ftg_write("mo_advection_utils__ptr_delp_mc_now", mo_advection_utils__ptr_delp_mc_now, LBOUND( &
+      &  mo_advection_utils__ptr_delp_mc_now), UBOUND(mo_advection_utils__ptr_delp_mc_now))
+    END IF
+    CALL ftg_write("mo_nonhydrostatic_config__rayleigh_type", mo_nonhydrostatic_config__rayleigh_type)
+    IF (ALLOCATED(mo_icon_comm_lib__recv_buffer)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__recv_buffer)
+      !$ACC UPDATE HOST( mo_icon_comm_lib__recv_buffer )
+#endif
+      
+      CALL ftg_write("mo_icon_comm_lib__recv_buffer", mo_icon_comm_lib__recv_buffer, LBOUND(mo_icon_comm_lib__recv_buffer), &
+      &  UBOUND(mo_icon_comm_lib__recv_buffer))
+    END IF
+    CALL ftg_write("mo_nonhydrostatic_config__rhotheta_offctr", mo_nonhydrostatic_config__rhotheta_offctr)
+    IF (ALLOCATED(mo_icon_comm_lib__send_buffer)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__send_buffer)
+      !$ACC UPDATE HOST( mo_icon_comm_lib__send_buffer )
+#endif
+      
+      CALL ftg_write("mo_icon_comm_lib__send_buffer", mo_icon_comm_lib__send_buffer, LBOUND(mo_icon_comm_lib__send_buffer), &
+      &  UBOUND(mo_icon_comm_lib__send_buffer))
+    END IF
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_advection_config__shape_func)
+    !$ACC UPDATE HOST( mo_advection_config__shape_func )
+#endif
+    
+    CALL ftg_write("mo_advection_config__shape_func", mo_advection_config__shape_func, LBOUND(mo_advection_config__shape_func), &
+    &  UBOUND(mo_advection_config__shape_func))
+    CALL ftg_write("mo_parallel_config__sync_barrier_mode", mo_parallel_config__sync_barrier_mode)
+    CALL ftg_write("mo_icon_comm_lib__this_is_mpi_sequential", mo_icon_comm_lib__this_is_mpi_sequential)
+    CALL ftg_write("mo_timer__timer_back_traj", mo_timer__timer_back_traj)
+    CALL ftg_write("mo_timer__timer_barrier", mo_timer__timer_barrier)
+    CALL ftg_write("mo_timer__timer_icon_comm_barrier_2", mo_timer__timer_icon_comm_barrier_2)
+    CALL ftg_write("mo_timer__timer_icon_comm_fillrecv", mo_timer__timer_icon_comm_fillrecv)
+    CALL ftg_write("mo_timer__timer_icon_comm_fillsend", mo_timer__timer_icon_comm_fillsend)
+    CALL ftg_write("mo_timer__timer_icon_comm_ircv", mo_timer__timer_icon_comm_ircv)
+    CALL ftg_write("mo_timer__timer_icon_comm_sync", mo_timer__timer_icon_comm_sync)
+    CALL ftg_write("mo_timer__timer_icon_comm_wait", mo_timer__timer_icon_comm_wait)
+    CALL ftg_write("mo_timer__timer_intp", mo_timer__timer_intp)
+    CALL ftg_write("mo_timer__timer_solve_nh", mo_timer__timer_solve_nh)
+    CALL ftg_write("mo_timer__timer_solve_nh_cellcomp", mo_timer__timer_solve_nh_cellcomp)
+    CALL ftg_write("mo_timer__timer_solve_nh_edgecomp", mo_timer__timer_solve_nh_edgecomp)
+    CALL ftg_write("mo_timer__timer_solve_nh_exch", mo_timer__timer_solve_nh_exch)
+    CALL ftg_write("mo_timer__timer_solve_nh_veltend", mo_timer__timer_solve_nh_veltend)
+    CALL ftg_write("mo_timer__timer_solve_nh_vimpl", mo_timer__timer_solve_nh_vimpl)
+    CALL ftg_write("mo_timer__timer_solve_nh_vnupd", mo_timer__timer_solve_nh_vnupd)
+    CALL ftg_write("mo_run_config__timers_level", mo_run_config__timers_level)
+    CALL ftg_write("mo_parallel_config__use_dycore_barrier", mo_parallel_config__use_dycore_barrier)
+    CALL ftg_write("mo_parallel_config__use_icon_comm", mo_parallel_config__use_icon_comm)
+    IF (ALLOCATED(mo_vertical_coord_table__vct_a)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_vertical_coord_table__vct_a)
+      !$ACC UPDATE HOST( mo_vertical_coord_table__vct_a )
+#endif
+      
+      CALL ftg_write("mo_vertical_coord_table__vct_a", mo_vertical_coord_table__vct_a, LBOUND(mo_vertical_coord_table__vct_a), &
+      &  UBOUND(mo_vertical_coord_table__vct_a))
+    END IF
+    CALL ftg_write("mo_nonhydrostatic_config__veladv_offctr", mo_nonhydrostatic_config__veladv_offctr)
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_advection_config__wgt_eta)
+    !$ACC UPDATE HOST( mo_advection_config__wgt_eta )
+#endif
+    
+    CALL ftg_write("mo_advection_config__wgt_eta", mo_advection_config__wgt_eta, LBOUND(mo_advection_config__wgt_eta), UBOUND( &
+    &  mo_advection_config__wgt_eta))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_advection_config__wgt_zeta)
+    !$ACC UPDATE HOST( mo_advection_config__wgt_zeta )
+#endif
+    
+    CALL ftg_write("mo_advection_config__wgt_zeta", mo_advection_config__wgt_zeta, LBOUND(mo_advection_config__wgt_zeta), UBOUND( &
+    &  mo_advection_config__wgt_zeta))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_advection_config__zeta)
+    !$ACC UPDATE HOST( mo_advection_config__zeta )
+#endif
+    
+    CALL ftg_write("mo_advection_config__zeta", mo_advection_config__zeta, LBOUND(mo_advection_config__zeta), UBOUND( &
+    &  mo_advection_config__zeta))
+    CALL ftg_register_only("mo_advection_config__advection_config", "TYPE(t_advection_config)", LBOUND( &
+    &  mo_advection_config__advection_config), UBOUND(mo_advection_config__advection_config))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_advection_config__advection_config_beta_fct)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( mo_advection_config__advection_config%beta_fct )
+#endif
+    
+    
+    CALL ftg_write("mo_advection_config__advection_config%beta_fct", mo_advection_config__advection_config%beta_fct, LBOUND( &
+    &  mo_advection_config__advection_config%beta_fct), UBOUND(mo_advection_config__advection_config%beta_fct))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_advection_config__advection_config_llsq_svd)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( mo_advection_config__advection_config%llsq_svd )
+#endif
+    
+    
+    CALL ftg_write("mo_advection_config__advection_config%llsq_svd", mo_advection_config__advection_config%llsq_svd, LBOUND( &
+    &  mo_advection_config__advection_config%llsq_svd), UBOUND(mo_advection_config__advection_config%llsq_svd))
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+      CALL ftg_register_only("mo_icon_comm_lib__comm_variable", "TYPE(t_comm_variable_real)", LBOUND( &
+      &  mo_icon_comm_lib__comm_variable), UBOUND(mo_icon_comm_lib__comm_variable))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__comm_variable_comm_buffer)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable%comm_buffer )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__comm_variable%comm_buffer", mo_icon_comm_lib__comm_variable%comm_buffer, LBOUND( &
+      &  mo_icon_comm_lib__comm_variable%comm_buffer), UBOUND(mo_icon_comm_lib__comm_variable%comm_buffer))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__comm_variable_comm_pattern_index)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable%comm_pattern_index )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__comm_variable%comm_pattern_index", mo_icon_comm_lib__comm_variable%comm_pattern_index, &
+      &  LBOUND(mo_icon_comm_lib__comm_variable%comm_pattern_index), UBOUND(mo_icon_comm_lib__comm_variable%comm_pattern_index))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__comm_variable_comm_status)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable%comm_status )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__comm_variable%comm_status", mo_icon_comm_lib__comm_variable%comm_status, LBOUND( &
+      &  mo_icon_comm_lib__comm_variable%comm_status), UBOUND(mo_icon_comm_lib__comm_variable%comm_status))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__comm_variable_dim_4)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable%dim_4 )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__comm_variable%dim_4", mo_icon_comm_lib__comm_variable%dim_4, LBOUND( &
+      &  mo_icon_comm_lib__comm_variable%dim_4), UBOUND(mo_icon_comm_lib__comm_variable%dim_4))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__comm_variable_grid_dim)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable%grid_dim )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__comm_variable%grid_dim", mo_icon_comm_lib__comm_variable%grid_dim, LBOUND( &
+      &  mo_icon_comm_lib__comm_variable%grid_dim), UBOUND(mo_icon_comm_lib__comm_variable%grid_dim))
+    END IF
+    ! *** WARNING: Type not supported by serialbox ***
+    !     mo_icon_comm_lib__comm_variable%name
+    !     CHARACTER(len=32) | dimension: 0
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__comm_variable_no_of_variables)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable%no_of_variables )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__comm_variable%no_of_variables", mo_icon_comm_lib__comm_variable%no_of_variables, LBOUND( &
+      &  mo_icon_comm_lib__comm_variable%no_of_variables), UBOUND(mo_icon_comm_lib__comm_variable%no_of_variables))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+      DO ftg_d1 = LBOUND(mo_icon_comm_lib__comm_variable, 1), UBOUND(mo_icon_comm_lib__comm_variable, 1)
+        WRITE (ftg_c,'(A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%recv_values_2d'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_a57891)
+        ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+        !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable(ftg_d1)%recv_values_2d )
+#endif
+        
+        
+        CALL ftg_write(ftg_c, mo_icon_comm_lib__comm_variable(ftg_d1)%recv_values_2d, LBOUND(mo_icon_comm_lib__comm_variable( &
+        &  ftg_d1)%recv_values_2d), UBOUND(mo_icon_comm_lib__comm_variable(ftg_d1)%recv_values_2d))
+      END DO
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+      DO ftg_d1 = LBOUND(mo_icon_comm_lib__comm_variable, 1), UBOUND(mo_icon_comm_lib__comm_variable, 1)
+        WRITE (ftg_c,'(A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%recv_values_3d'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_525c55)
+        ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+        !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable(ftg_d1)%recv_values_3d )
+#endif
+        
+        
+        CALL ftg_write(ftg_c, mo_icon_comm_lib__comm_variable(ftg_d1)%recv_values_3d, LBOUND(mo_icon_comm_lib__comm_variable( &
+        &  ftg_d1)%recv_values_3d), UBOUND(mo_icon_comm_lib__comm_variable(ftg_d1)%recv_values_3d))
+      END DO
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+      DO ftg_d1 = LBOUND(mo_icon_comm_lib__comm_variable, 1), UBOUND(mo_icon_comm_lib__comm_variable, 1)
+        WRITE (ftg_c,'(A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%recv_values_4d'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_a2084c)
+        ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+        !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable(ftg_d1)%recv_values_4d )
+#endif
+        
+        
+        CALL ftg_write(ftg_c, mo_icon_comm_lib__comm_variable(ftg_d1)%recv_values_4d, LBOUND(mo_icon_comm_lib__comm_variable( &
+        &  ftg_d1)%recv_values_4d), UBOUND(mo_icon_comm_lib__comm_variable(ftg_d1)%recv_values_4d))
+      END DO
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__comm_variable_request)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable%request )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__comm_variable%request", mo_icon_comm_lib__comm_variable%request, LBOUND( &
+      &  mo_icon_comm_lib__comm_variable%request), UBOUND(mo_icon_comm_lib__comm_variable%request))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__comm_variable_scope)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable%scope )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__comm_variable%scope", mo_icon_comm_lib__comm_variable%scope, LBOUND( &
+      &  mo_icon_comm_lib__comm_variable%scope), UBOUND(mo_icon_comm_lib__comm_variable%scope))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+      DO ftg_d1 = LBOUND(mo_icon_comm_lib__comm_variable, 1), UBOUND(mo_icon_comm_lib__comm_variable, 1)
+        WRITE (ftg_c,'(A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%send_values_2d'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_77eae8)
+        ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+        !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable(ftg_d1)%send_values_2d )
+#endif
+        
+        
+        CALL ftg_write(ftg_c, mo_icon_comm_lib__comm_variable(ftg_d1)%send_values_2d, LBOUND(mo_icon_comm_lib__comm_variable( &
+        &  ftg_d1)%send_values_2d), UBOUND(mo_icon_comm_lib__comm_variable(ftg_d1)%send_values_2d))
+      END DO
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+      DO ftg_d1 = LBOUND(mo_icon_comm_lib__comm_variable, 1), UBOUND(mo_icon_comm_lib__comm_variable, 1)
+        WRITE (ftg_c,'(A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%send_values_3d'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_9db3f8)
+        ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+        !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable(ftg_d1)%send_values_3d )
+#endif
+        
+        
+        CALL ftg_write(ftg_c, mo_icon_comm_lib__comm_variable(ftg_d1)%send_values_3d, LBOUND(mo_icon_comm_lib__comm_variable( &
+        &  ftg_d1)%send_values_3d), UBOUND(mo_icon_comm_lib__comm_variable(ftg_d1)%send_values_3d))
+      END DO
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+      DO ftg_d1 = LBOUND(mo_icon_comm_lib__comm_variable, 1), UBOUND(mo_icon_comm_lib__comm_variable, 1)
+        WRITE (ftg_c,'(A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%send_values_4d'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_e80b38)
+        ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+        !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable(ftg_d1)%send_values_4d )
+#endif
+        
+        
+        CALL ftg_write(ftg_c, mo_icon_comm_lib__comm_variable(ftg_d1)%send_values_4d, LBOUND(mo_icon_comm_lib__comm_variable( &
+        &  ftg_d1)%send_values_4d), UBOUND(mo_icon_comm_lib__comm_variable(ftg_d1)%send_values_4d))
+      END DO
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__comm_variable_status)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable%status )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__comm_variable%status", mo_icon_comm_lib__comm_variable%status, LBOUND( &
+      &  mo_icon_comm_lib__comm_variable%status), UBOUND(mo_icon_comm_lib__comm_variable%status))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__comm_variable_vertical_layers)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable%vertical_layers )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__comm_variable%vertical_layers", mo_icon_comm_lib__comm_variable%vertical_layers, LBOUND( &
+      &  mo_icon_comm_lib__comm_variable%vertical_layers), UBOUND(mo_icon_comm_lib__comm_variable%vertical_layers))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__grid_comm_pattern_list)) THEN
+      CALL ftg_register_only("mo_icon_comm_lib__grid_comm_pattern_list", "TYPE(t_grid_comm_pattern)", LBOUND( &
+      &  mo_icon_comm_lib__grid_comm_pattern_list), UBOUND(mo_icon_comm_lib__grid_comm_pattern_list))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__grid_comm_pattern_list)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__grid_comm_pattern_list_status)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__grid_comm_pattern_list%status )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__grid_comm_pattern_list%status", mo_icon_comm_lib__grid_comm_pattern_list%status, LBOUND( &
+      &  mo_icon_comm_lib__grid_comm_pattern_list%status), UBOUND(mo_icon_comm_lib__grid_comm_pattern_list%status))
+    END IF
+    CALL ftg_register_only("mo_interpol_config__lsq_high_set", "TYPE(t_lsq_set)")
+    CALL ftg_write("mo_interpol_config__lsq_high_set%dim_c", mo_interpol_config__lsq_high_set%dim_c)
+    CALL ftg_write("mo_interpol_config__lsq_high_set%dim_unk", mo_interpol_config__lsq_high_set%dim_unk)
+    IF (ALLOCATED(mo_icon_comm_lib__recv_procs_buffer)) THEN
+      CALL ftg_register_only("mo_icon_comm_lib__recv_procs_buffer", "TYPE(t_comm_process_buffer)", LBOUND( &
+      &  mo_icon_comm_lib__recv_procs_buffer), UBOUND(mo_icon_comm_lib__recv_procs_buffer))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__recv_procs_buffer)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__recv_procs_buffer_buffer_size)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__recv_procs_buffer%buffer_size )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__recv_procs_buffer%buffer_size", mo_icon_comm_lib__recv_procs_buffer%buffer_size, LBOUND( &
+      &  mo_icon_comm_lib__recv_procs_buffer%buffer_size), UBOUND(mo_icon_comm_lib__recv_procs_buffer%buffer_size))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__recv_procs_buffer)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__recv_procs_buffer_current_index)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__recv_procs_buffer%current_index )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__recv_procs_buffer%current_index", mo_icon_comm_lib__recv_procs_buffer%current_index, &
+      &  LBOUND(mo_icon_comm_lib__recv_procs_buffer%current_index), UBOUND(mo_icon_comm_lib__recv_procs_buffer%current_index))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__recv_procs_buffer)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__recv_procs_buffer_pid)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__recv_procs_buffer%pid )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__recv_procs_buffer%pid", mo_icon_comm_lib__recv_procs_buffer%pid, LBOUND( &
+      &  mo_icon_comm_lib__recv_procs_buffer%pid), UBOUND(mo_icon_comm_lib__recv_procs_buffer%pid))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__recv_procs_buffer)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__recv_procs_buffer_start_index)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__recv_procs_buffer%start_index )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__recv_procs_buffer%start_index", mo_icon_comm_lib__recv_procs_buffer%start_index, LBOUND( &
+      &  mo_icon_comm_lib__recv_procs_buffer%start_index), UBOUND(mo_icon_comm_lib__recv_procs_buffer%start_index))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__send_procs_buffer)) THEN
+      CALL ftg_register_only("mo_icon_comm_lib__send_procs_buffer", "TYPE(t_comm_process_buffer)", LBOUND( &
+      &  mo_icon_comm_lib__send_procs_buffer), UBOUND(mo_icon_comm_lib__send_procs_buffer))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__send_procs_buffer)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__send_procs_buffer_buffer_size)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__send_procs_buffer%buffer_size )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__send_procs_buffer%buffer_size", mo_icon_comm_lib__send_procs_buffer%buffer_size, LBOUND( &
+      &  mo_icon_comm_lib__send_procs_buffer%buffer_size), UBOUND(mo_icon_comm_lib__send_procs_buffer%buffer_size))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__send_procs_buffer)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__send_procs_buffer_current_index)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__send_procs_buffer%current_index )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__send_procs_buffer%current_index", mo_icon_comm_lib__send_procs_buffer%current_index, &
+      &  LBOUND(mo_icon_comm_lib__send_procs_buffer%current_index), UBOUND(mo_icon_comm_lib__send_procs_buffer%current_index))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__send_procs_buffer)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__send_procs_buffer_end_index)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__send_procs_buffer%end_index )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__send_procs_buffer%end_index", mo_icon_comm_lib__send_procs_buffer%end_index, LBOUND( &
+      &  mo_icon_comm_lib__send_procs_buffer%end_index), UBOUND(mo_icon_comm_lib__send_procs_buffer%end_index))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__send_procs_buffer)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__send_procs_buffer_pid)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__send_procs_buffer%pid )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__send_procs_buffer%pid", mo_icon_comm_lib__send_procs_buffer%pid, LBOUND( &
+      &  mo_icon_comm_lib__send_procs_buffer%pid), UBOUND(mo_icon_comm_lib__send_procs_buffer%pid))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__send_procs_buffer)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__send_procs_buffer_start_index)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__send_procs_buffer%start_index )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__send_procs_buffer%start_index", mo_icon_comm_lib__send_procs_buffer%start_index, LBOUND( &
+      &  mo_icon_comm_lib__send_procs_buffer%start_index), UBOUND(mo_icon_comm_lib__send_procs_buffer%start_index))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+      DO ftg_d1 = LBOUND(mo_icon_comm_lib__comm_variable, 1), UBOUND(mo_icon_comm_lib__comm_variable, 1)
+        IF (ASSOCIATED(mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern)) THEN
+          WRITE (ftg_c,'(A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%grid_comm_pattern'
+          CALL ftg_register_only(ftg_c, "TYPE(t_grid_comm_pattern)")
+          WRITE (ftg_c,'(A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%grid_comm_pattern%no_of_recv_procs'
+          CALL ftg_write(ftg_c, mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%no_of_recv_procs)
+        END IF
+      END DO
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+      DO ftg_d1 = LBOUND(mo_icon_comm_lib__comm_variable, 1), UBOUND(mo_icon_comm_lib__comm_variable, 1)
+        IF (ASSOCIATED(mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern)) THEN
+          WRITE (ftg_c,'(A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%grid_comm_pattern%no_of_send_procs'
+          CALL ftg_write(ftg_c, mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%no_of_send_procs)
+        END IF
+      END DO
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+      DO ftg_d1 = LBOUND(mo_icon_comm_lib__comm_variable, 1), UBOUND(mo_icon_comm_lib__comm_variable, 1)
+        IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+          WRITE (ftg_c,'(A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%grid_comm_pattern%recv'
+          CALL ftg_register_only(ftg_c, "TYPE(t_process_comm_pattern)", LBOUND(mo_icon_comm_lib__comm_variable(ftg_d1)% &
+          &  grid_comm_pattern%recv), UBOUND(mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv))
+        END IF
+        IF (ASSOCIATED(mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv)) THEN
+          DO ftg_d2 = LBOUND(mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv, 1), UBOUND( &
+          &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv, 1)
+            WRITE (ftg_c,'(A,I0,A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%grid_comm_pattern%recv(', ftg_d2, &
+            &  ')%block_no'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_c68ce1)
+            ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+            !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv(ftg_d2)%block_no )
+#endif
+            
+            
+            CALL ftg_write(ftg_c, mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv(ftg_d2)%block_no, LBOUND( &
+            &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv(ftg_d2)%block_no), UBOUND( &
+            &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv(ftg_d2)%block_no))
+          END DO
+        END IF
+      END DO
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+      DO ftg_d1 = LBOUND(mo_icon_comm_lib__comm_variable, 1), UBOUND(mo_icon_comm_lib__comm_variable, 1)
+        IF (ASSOCIATED(mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern)) THEN
+          IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+            WRITE (ftg_c,'(A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%grid_comm_pattern%recv%buffer_index'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_ef9557)
+            ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+            !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv%buffer_index )
+#endif
+            
+            
+            CALL ftg_write(ftg_c, mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv%buffer_index, LBOUND( &
+            &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv%buffer_index), UBOUND( &
+            &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv%buffer_index))
+          END IF
+        END IF
+      END DO
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+      DO ftg_d1 = LBOUND(mo_icon_comm_lib__comm_variable, 1), UBOUND(mo_icon_comm_lib__comm_variable, 1)
+        IF (ASSOCIATED(mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv)) THEN
+          DO ftg_d2 = LBOUND(mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv, 1), UBOUND( &
+          &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv, 1)
+            WRITE (ftg_c,'(A,I0,A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%grid_comm_pattern%recv(', ftg_d2, &
+            &  ')%index_no'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_af8093)
+            ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+            !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv(ftg_d2)%index_no )
+#endif
+            
+            
+            CALL ftg_write(ftg_c, mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv(ftg_d2)%index_no, LBOUND( &
+            &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv(ftg_d2)%index_no), UBOUND( &
+            &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv(ftg_d2)%index_no))
+          END DO
+        END IF
+      END DO
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+      DO ftg_d1 = LBOUND(mo_icon_comm_lib__comm_variable, 1), UBOUND(mo_icon_comm_lib__comm_variable, 1)
+        IF (ASSOCIATED(mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern)) THEN
+          IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+            WRITE (ftg_c,'(A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%grid_comm_pattern%recv%no_of_points'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_2ef5e6)
+            ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+            !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv%no_of_points )
+#endif
+            
+            
+            CALL ftg_write(ftg_c, mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv%no_of_points, LBOUND( &
+            &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv%no_of_points), UBOUND( &
+            &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv%no_of_points))
+          END IF
+        END IF
+      END DO
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+      DO ftg_d1 = LBOUND(mo_icon_comm_lib__comm_variable, 1), UBOUND(mo_icon_comm_lib__comm_variable, 1)
+        IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+          WRITE (ftg_c,'(A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%grid_comm_pattern%send'
+          CALL ftg_register_only(ftg_c, "TYPE(t_process_comm_pattern)", LBOUND(mo_icon_comm_lib__comm_variable(ftg_d1)% &
+          &  grid_comm_pattern%send), UBOUND(mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send))
+        END IF
+        IF (ASSOCIATED(mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send)) THEN
+          DO ftg_d2 = LBOUND(mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send, 1), UBOUND( &
+          &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send, 1)
+            WRITE (ftg_c,'(A,I0,A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%grid_comm_pattern%send(', ftg_d2, &
+            &  ')%block_no'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_78090e)
+            ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+            !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send(ftg_d2)%block_no )
+#endif
+            
+            
+            CALL ftg_write(ftg_c, mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send(ftg_d2)%block_no, LBOUND( &
+            &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send(ftg_d2)%block_no), UBOUND( &
+            &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send(ftg_d2)%block_no))
+          END DO
+        END IF
+      END DO
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+      DO ftg_d1 = LBOUND(mo_icon_comm_lib__comm_variable, 1), UBOUND(mo_icon_comm_lib__comm_variable, 1)
+        IF (ASSOCIATED(mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern)) THEN
+          IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+            WRITE (ftg_c,'(A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%grid_comm_pattern%send%buffer_index'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_43d846)
+            ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+            !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send%buffer_index )
+#endif
+            
+            
+            CALL ftg_write(ftg_c, mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send%buffer_index, LBOUND( &
+            &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send%buffer_index), UBOUND( &
+            &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send%buffer_index))
+          END IF
+        END IF
+      END DO
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+      DO ftg_d1 = LBOUND(mo_icon_comm_lib__comm_variable, 1), UBOUND(mo_icon_comm_lib__comm_variable, 1)
+        IF (ASSOCIATED(mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send)) THEN
+          DO ftg_d2 = LBOUND(mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send, 1), UBOUND( &
+          &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send, 1)
+            WRITE (ftg_c,'(A,I0,A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%grid_comm_pattern%send(', ftg_d2, &
+            &  ')%index_no'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_54545d)
+            ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+            !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send(ftg_d2)%index_no )
+#endif
+            
+            
+            CALL ftg_write(ftg_c, mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send(ftg_d2)%index_no, LBOUND( &
+            &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send(ftg_d2)%index_no), UBOUND( &
+            &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send(ftg_d2)%index_no))
+          END DO
+        END IF
+      END DO
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+      DO ftg_d1 = LBOUND(mo_icon_comm_lib__comm_variable, 1), UBOUND(mo_icon_comm_lib__comm_variable, 1)
+        IF (ASSOCIATED(mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern)) THEN
+          IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+            WRITE (ftg_c,'(A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%grid_comm_pattern%send%no_of_points'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_f10645)
+            ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+            !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send%no_of_points )
+#endif
+            
+            
+            CALL ftg_write(ftg_c, mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send%no_of_points, LBOUND( &
+            &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send%no_of_points), UBOUND( &
+            &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send%no_of_points))
+          END IF
+        END IF
+      END DO
+    END IF
+    
+    
+    CALL ftg_write("ftg_solve_nh_round", ftg_solve_nh_round)
+    
+    CALL ftg_destroy_savepoint()
+    WRITE (0,*) 'FTG FINALIZE INPUT DATA solve_nh', get_my_mpi_all_id()
+    CALL ftg_destroy_serializer()
+    
+    CALL end_loc_timing(10)
+  END IF
+  
+  CALL start_loc_timing("solve_nh: computation", 11)
+  
+END SUBROUTINE ftg_solve_nh_capture_input
+
+LOGICAL FUNCTION ftg_solve_nh_capture_output_active()
+
+ftg_solve_nh_capture_output_active =       &
+ftg_solve_nh_capture_output_enabled .AND.  &
+ftg_solve_nh_round .EQ. ftg_solve_nh_capture_round
+
+END FUNCTION ftg_solve_nh_capture_output_active
+
+SUBROUTINE ftg_solve_nh_capture_output(p_nh, p_patch, prep_adv)
+  
+  USE mo_mpi, ONLY: work_mpi_barrier, get_my_mpi_all_id
+  USE mo_exception, ONLY: finish
+  USE m_ser_ftg, ONLY: ftg_set_savepoint, ftg_write, ftg_register_only, ftg_destroy_savepoint, ftg_destroy_serializer
+  USE timing_tools, ONLY: start_loc_timing, end_loc_timing
+  
+  USE mo_dynamics_config, ONLY: mo_dynamics_config__idiv_method => idiv_method
+  USE mo_run_config, ONLY: mo_run_config__ltimer => ltimer, mo_run_config__timers_level => timers_level, mo_run_config__lvert_nest &
+  &  => lvert_nest
+  USE mo_initicon_config, ONLY: mo_initicon_config__is_iau_active => is_iau_active, mo_initicon_config__iau_wgt_dyn => iau_wgt_dyn
+  USE mo_interpol_config, ONLY: mo_interpol_config__lsq_high_ord => lsq_high_ord, mo_interpol_config__lsq_high_set => &
+  &  lsq_high_set, mo_interpol_config__nudge_max_coeff => nudge_max_coeff, t_lsq_set
+  USE mo_sync, ONLY: mo_sync__log_unit => log_unit, mo_sync__do_sync_checks => do_sync_checks
+  USE mo_init_vgrid, ONLY: mo_init_vgrid__nflatlev => nflatlev
+  USE mo_nonhydrostatic_config, ONLY: mo_nonhydrostatic_config__lextra_diffu => lextra_diffu, &
+  &  mo_nonhydrostatic_config__divdamp_type => divdamp_type, mo_nonhydrostatic_config__rayleigh_type => rayleigh_type, &
+  &  mo_nonhydrostatic_config__veladv_offctr => veladv_offctr, mo_nonhydrostatic_config__kstart_moist => kstart_moist, &
+  &  mo_nonhydrostatic_config__kstart_dd3d => kstart_dd3d, mo_nonhydrostatic_config__ndyn_substeps_var => ndyn_substeps_var, &
+  &  mo_nonhydrostatic_config__divdamp_order => divdamp_order, mo_nonhydrostatic_config__divdamp_fac_o2 => divdamp_fac_o2, &
+  &  mo_nonhydrostatic_config__lhdiff_rcf => lhdiff_rcf, mo_nonhydrostatic_config__igradp_method => igradp_method, &
+  &  mo_nonhydrostatic_config__itime_scheme => itime_scheme, mo_nonhydrostatic_config__divdamp_fac => divdamp_fac, &
+  &  mo_nonhydrostatic_config__rhotheta_offctr => rhotheta_offctr, mo_nonhydrostatic_config__l_open_ubc => l_open_ubc, &
+  &  mo_nonhydrostatic_config__iadv_rhotheta => iadv_rhotheta
+  USE mo_timer, ONLY: mo_timer__timer_solve_nh_cellcomp => timer_solve_nh_cellcomp, mo_timer__timer_solve_nh => timer_solve_nh, &
+  &  mo_timer__timer_solve_nh_vimpl => timer_solve_nh_vimpl, mo_timer__timer_icon_comm_wait => timer_icon_comm_wait, &
+  &  mo_timer__timer_icon_comm_fillrecv => timer_icon_comm_fillrecv, mo_timer__timer_solve_nh_edgecomp => timer_solve_nh_edgecomp, &
+  &  mo_timer__timer_solve_nh_veltend => timer_solve_nh_veltend, mo_timer__timer_icon_comm_fillsend => timer_icon_comm_fillsend, &
+  &  mo_timer__timer_solve_nh_vnupd => timer_solve_nh_vnupd, mo_timer__timer_icon_comm_ircv => timer_icon_comm_ircv, &
+  &  mo_timer__timer_back_traj => timer_back_traj, mo_timer__timer_barrier => timer_barrier, mo_timer__timer_solve_nh_exch => &
+  &  timer_solve_nh_exch, mo_timer__timer_icon_comm_sync => timer_icon_comm_sync, mo_timer__timer_icon_comm_barrier_2 => &
+  &  timer_icon_comm_barrier_2, mo_timer__timer_intp => timer_intp
+  USE mo_vertical_coord_table, ONLY: mo_vertical_coord_table__vct_a => vct_a
+  USE mo_advection_config, ONLY: mo_advection_config__zeta => zeta, mo_advection_config__wgt_zeta => wgt_zeta, &
+  &  mo_advection_config__eta => eta, mo_advection_config__advection_config => advection_config, mo_advection_config__wgt_eta => &
+  &  wgt_eta, mo_advection_config__shape_func => shape_func, t_advection_config
+  USE mo_icon_comm_lib, ONLY: mo_icon_comm_lib__active_send_buffers => active_send_buffers, mo_icon_comm_lib__comm_variable => &
+  &  comm_variable, mo_icon_comm_lib__log_file_id => log_file_id, mo_icon_comm_lib__my_work_communicator => my_work_communicator, &
+  &  mo_icon_comm_lib__comm_lib_is_initialized => comm_lib_is_initialized, mo_icon_comm_lib__max_send_buffer_size => &
+  &  max_send_buffer_size, mo_icon_comm_lib__recv_buffer => recv_buffer, mo_icon_comm_lib__send_procs_buffer => send_procs_buffer, &
+  &  mo_icon_comm_lib__this_is_mpi_sequential => this_is_mpi_sequential, mo_icon_comm_lib__active_comm_variables => &
+  &  active_comm_variables, mo_icon_comm_lib__send_buffer => send_buffer, mo_icon_comm_lib__max_active_comm_variables => &
+  &  max_active_comm_variables, mo_icon_comm_lib__buffer_comm_status => buffer_comm_status, &
+  &  mo_icon_comm_lib__grid_comm_pattern_list => grid_comm_pattern_list, mo_icon_comm_lib__recv_procs_buffer => recv_procs_buffer, &
+  &  mo_icon_comm_lib__active_recv_buffers => active_recv_buffers, t_comm_process_buffer, t_comm_variable_real, t_grid_comm_pattern
+  USE mo_vertical_grid, ONLY: mo_vertical_grid__nflat_gradp => nflat_gradp, mo_vertical_grid__nrdmax => nrdmax
+  USE mo_parallel_config, ONLY: mo_parallel_config__max_no_of_comm_variables => max_no_of_comm_variables, &
+  &  mo_parallel_config__itype_comm => itype_comm, mo_parallel_config__use_icon_comm => use_icon_comm, &
+  &  mo_parallel_config__sync_barrier_mode => sync_barrier_mode, mo_parallel_config__nproma => nproma, &
+  &  mo_parallel_config__icon_comm_method => icon_comm_method, mo_parallel_config__icon_comm_debug => icon_comm_debug, &
+  &  mo_parallel_config__l_log_checks => l_log_checks, mo_parallel_config__n_ghost_rows => n_ghost_rows, &
+  &  mo_parallel_config__use_dycore_barrier => use_dycore_barrier, mo_parallel_config__max_mpi_message_size => &
+  &  max_mpi_message_size, mo_parallel_config__p_test_run => p_test_run
+  USE mo_grid_config, ONLY: mo_grid_config__l_limited_area => l_limited_area
+  USE mo_gridref_config, ONLY: mo_gridref_config__grf_intmethod_e => grf_intmethod_e
+  USE mo_advection_utils, ONLY: mo_advection_utils__ptr_delp_mc_now => ptr_delp_mc_now, mo_advection_utils__ptr_delp_mc_new => &
+  &  ptr_delp_mc_new
+  
+  TYPE(t_nh_state), INTENT(in) :: p_nh
+  TYPE(t_patch), INTENT(in) :: p_patch
+  TYPE(t_prepare_adv), INTENT(in) :: prep_adv
+  
+  INTEGER :: ftg_d1, ftg_d2, ftg_d3, ftg_d4
+  CHARACTER(len=256) :: ftg_c
+  
+  CALL end_loc_timing(11)
+  
+  IF (ftg_solve_nh_capture_output_active()) THEN
+    CALL start_loc_timing("solve_nh: FTG capture output", 19)
+    
+    CALL ftg_solve_nh_init_for_capture('output', ftg_solve_nh_output_dir)
+    CALL ftg_set_savepoint('output')
+    
+    WRITE (0,*) 'FTG ROUND solve_nh ', ftg_solve_nh_round, get_my_mpi_all_id()
+    WRITE (0,*) 'FTG WRITE output DATA solve_nh', get_my_mpi_all_id()
+    
+    
+    ! BASIC ARGUMENTS
+    
+    
+    ! OPTIONAL ARGUMENTS
+    
+    ! TYPE MEMBERS
+    CALL ftg_register_only("p_nh", "TYPE(t_nh_state)")
+    CALL ftg_register_only("p_nh%diag", "TYPE(t_nh_diag)")
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_ddt_exner_phy)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%ddt_exner_phy )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%ddt_exner_phy", p_nh%diag%ddt_exner_phy, LBOUND(p_nh%diag%ddt_exner_phy), UBOUND(p_nh%diag% &
+    &  ddt_exner_phy))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_ddt_vn_adv)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%ddt_vn_adv )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%ddt_vn_adv", p_nh%diag%ddt_vn_adv, LBOUND(p_nh%diag%ddt_vn_adv), UBOUND(p_nh%diag%ddt_vn_adv))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_ddt_vn_phy)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%ddt_vn_phy )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%ddt_vn_phy", p_nh%diag%ddt_vn_phy, LBOUND(p_nh%diag%ddt_vn_phy), UBOUND(p_nh%diag%ddt_vn_phy))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_ddt_w_adv)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%ddt_w_adv )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%ddt_w_adv", p_nh%diag%ddt_w_adv, LBOUND(p_nh%diag%ddt_w_adv), UBOUND(p_nh%diag%ddt_w_adv))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_dtheta_v_ic_int)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%dtheta_v_ic_int )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%dtheta_v_ic_int", p_nh%diag%dtheta_v_ic_int, LBOUND(p_nh%diag%dtheta_v_ic_int), UBOUND(p_nh%diag% &
+    &  dtheta_v_ic_int))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_dtheta_v_ic_ubc)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%dtheta_v_ic_ubc )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%dtheta_v_ic_ubc", p_nh%diag%dtheta_v_ic_ubc, LBOUND(p_nh%diag%dtheta_v_ic_ubc), UBOUND(p_nh%diag% &
+    &  dtheta_v_ic_ubc))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_dvn_ie_int)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%dvn_ie_int )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%dvn_ie_int", p_nh%diag%dvn_ie_int, LBOUND(p_nh%diag%dvn_ie_int), UBOUND(p_nh%diag%dvn_ie_int))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_dvn_ie_ubc)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%dvn_ie_ubc )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%dvn_ie_ubc", p_nh%diag%dvn_ie_ubc, LBOUND(p_nh%diag%dvn_ie_ubc), UBOUND(p_nh%diag%dvn_ie_ubc))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_dw_int)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%dw_int )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%dw_int", p_nh%diag%dw_int, LBOUND(p_nh%diag%dw_int), UBOUND(p_nh%diag%dw_int))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_dw_ubc)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%dw_ubc )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%dw_ubc", p_nh%diag%dw_ubc, LBOUND(p_nh%diag%dw_ubc), UBOUND(p_nh%diag%dw_ubc))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_exner_dyn_incr)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%exner_dyn_incr )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%exner_dyn_incr", p_nh%diag%exner_dyn_incr, LBOUND(p_nh%diag%exner_dyn_incr), UBOUND(p_nh%diag% &
+    &  exner_dyn_incr))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_exner_incr)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%exner_incr )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%exner_incr", p_nh%diag%exner_incr, LBOUND(p_nh%diag%exner_incr), UBOUND(p_nh%diag%exner_incr))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_exner_pr)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%exner_pr )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%exner_pr", p_nh%diag%exner_pr, LBOUND(p_nh%diag%exner_pr), UBOUND(p_nh%diag%exner_pr))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_grf_bdy_mflx)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%grf_bdy_mflx )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%grf_bdy_mflx", p_nh%diag%grf_bdy_mflx, LBOUND(p_nh%diag%grf_bdy_mflx), UBOUND(p_nh%diag%grf_bdy_mflx))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_grf_tend_mflx)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%grf_tend_mflx )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%grf_tend_mflx", p_nh%diag%grf_tend_mflx, LBOUND(p_nh%diag%grf_tend_mflx), UBOUND(p_nh%diag% &
+    &  grf_tend_mflx))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_grf_tend_rho)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%grf_tend_rho )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%grf_tend_rho", p_nh%diag%grf_tend_rho, LBOUND(p_nh%diag%grf_tend_rho), UBOUND(p_nh%diag%grf_tend_rho))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_grf_tend_thv)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%grf_tend_thv )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%grf_tend_thv", p_nh%diag%grf_tend_thv, LBOUND(p_nh%diag%grf_tend_thv), UBOUND(p_nh%diag%grf_tend_thv))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_grf_tend_vn)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%grf_tend_vn )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%grf_tend_vn", p_nh%diag%grf_tend_vn, LBOUND(p_nh%diag%grf_tend_vn), UBOUND(p_nh%diag%grf_tend_vn))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_grf_tend_w)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%grf_tend_w )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%grf_tend_w", p_nh%diag%grf_tend_w, LBOUND(p_nh%diag%grf_tend_w), UBOUND(p_nh%diag%grf_tend_w))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_mass_fl_e)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%mass_fl_e )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%mass_fl_e", p_nh%diag%mass_fl_e, LBOUND(p_nh%diag%mass_fl_e), UBOUND(p_nh%diag%mass_fl_e))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_mass_fl_e_sv)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%mass_fl_e_sv )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%mass_fl_e_sv", p_nh%diag%mass_fl_e_sv, LBOUND(p_nh%diag%mass_fl_e_sv), UBOUND(p_nh%diag%mass_fl_e_sv))
+    CALL ftg_write("p_nh%diag%max_vcfl_dyn", p_nh%diag%max_vcfl_dyn)
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_mflx_ic_int)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%mflx_ic_int )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%mflx_ic_int", p_nh%diag%mflx_ic_int, LBOUND(p_nh%diag%mflx_ic_int), UBOUND(p_nh%diag%mflx_ic_int))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_mflx_ic_ubc)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%mflx_ic_ubc )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%mflx_ic_ubc", p_nh%diag%mflx_ic_ubc, LBOUND(p_nh%diag%mflx_ic_ubc), UBOUND(p_nh%diag%mflx_ic_ubc))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_rho_ic)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%rho_ic )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%rho_ic", p_nh%diag%rho_ic, LBOUND(p_nh%diag%rho_ic), UBOUND(p_nh%diag%rho_ic))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_rho_incr)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%rho_incr )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%rho_incr", p_nh%diag%rho_incr, LBOUND(p_nh%diag%rho_incr), UBOUND(p_nh%diag%rho_incr))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_theta_v_ic)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%theta_v_ic )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%theta_v_ic", p_nh%diag%theta_v_ic, LBOUND(p_nh%diag%theta_v_ic), UBOUND(p_nh%diag%theta_v_ic))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_vn_ie)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%vn_ie )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%vn_ie", p_nh%diag%vn_ie, LBOUND(p_nh%diag%vn_ie), UBOUND(p_nh%diag%vn_ie))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_vn_incr)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%vn_incr )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%vn_incr", p_nh%diag%vn_incr, LBOUND(p_nh%diag%vn_incr), UBOUND(p_nh%diag%vn_incr))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_vt)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%vt )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%vt", p_nh%diag%vt, LBOUND(p_nh%diag%vt), UBOUND(p_nh%diag%vt))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_diag_w_concorr_c)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%diag%w_concorr_c )
+#endif
+    
+    
+    CALL ftg_write("p_nh%diag%w_concorr_c", p_nh%diag%w_concorr_c, LBOUND(p_nh%diag%w_concorr_c), UBOUND(p_nh%diag%w_concorr_c))
+    CALL ftg_register_only("p_nh%metrics", "TYPE(t_nh_metrics)")
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_bdy_halo_c_blk)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%bdy_halo_c_blk )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%bdy_halo_c_blk", p_nh%metrics%bdy_halo_c_blk, LBOUND(p_nh%metrics%bdy_halo_c_blk), UBOUND(p_nh% &
+    &  metrics%bdy_halo_c_blk))
+    CALL ftg_write("p_nh%metrics%bdy_halo_c_dim", p_nh%metrics%bdy_halo_c_dim)
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_bdy_halo_c_idx)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%bdy_halo_c_idx )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%bdy_halo_c_idx", p_nh%metrics%bdy_halo_c_idx, LBOUND(p_nh%metrics%bdy_halo_c_idx), UBOUND(p_nh% &
+    &  metrics%bdy_halo_c_idx))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_bdy_mflx_e_blk)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%bdy_mflx_e_blk )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%bdy_mflx_e_blk", p_nh%metrics%bdy_mflx_e_blk, LBOUND(p_nh%metrics%bdy_mflx_e_blk), UBOUND(p_nh% &
+    &  metrics%bdy_mflx_e_blk))
+    CALL ftg_write("p_nh%metrics%bdy_mflx_e_dim", p_nh%metrics%bdy_mflx_e_dim)
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_bdy_mflx_e_idx)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%bdy_mflx_e_idx )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%bdy_mflx_e_idx", p_nh%metrics%bdy_mflx_e_idx, LBOUND(p_nh%metrics%bdy_mflx_e_idx), UBOUND(p_nh% &
+    &  metrics%bdy_mflx_e_idx))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_coeff1_dwdz)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%coeff1_dwdz )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%coeff1_dwdz", p_nh%metrics%coeff1_dwdz, LBOUND(p_nh%metrics%coeff1_dwdz), UBOUND(p_nh%metrics% &
+    &  coeff1_dwdz))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_coeff2_dwdz)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%coeff2_dwdz )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%coeff2_dwdz", p_nh%metrics%coeff2_dwdz, LBOUND(p_nh%metrics%coeff2_dwdz), UBOUND(p_nh%metrics% &
+    &  coeff2_dwdz))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_coeff_gradekin)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%coeff_gradekin )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%coeff_gradekin", p_nh%metrics%coeff_gradekin, LBOUND(p_nh%metrics%coeff_gradekin), UBOUND(p_nh% &
+    &  metrics%coeff_gradekin))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_coeff_gradp)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%coeff_gradp )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%coeff_gradp", p_nh%metrics%coeff_gradp, LBOUND(p_nh%metrics%coeff_gradp), UBOUND(p_nh%metrics% &
+    &  coeff_gradp))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_d_exner_dz_ref_ic)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%d_exner_dz_ref_ic )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%d_exner_dz_ref_ic", p_nh%metrics%d_exner_dz_ref_ic, LBOUND(p_nh%metrics%d_exner_dz_ref_ic), &
+    &  UBOUND(p_nh%metrics%d_exner_dz_ref_ic))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_ddqz_z_full_e)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%ddqz_z_full_e )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%ddqz_z_full_e", p_nh%metrics%ddqz_z_full_e, LBOUND(p_nh%metrics%ddqz_z_full_e), UBOUND(p_nh% &
+    &  metrics%ddqz_z_full_e))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_ddqz_z_half)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%ddqz_z_half )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%ddqz_z_half", p_nh%metrics%ddqz_z_half, LBOUND(p_nh%metrics%ddqz_z_half), UBOUND(p_nh%metrics% &
+    &  ddqz_z_half))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_ddxn_z_full)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%ddxn_z_full )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%ddxn_z_full", p_nh%metrics%ddxn_z_full, LBOUND(p_nh%metrics%ddxn_z_full), UBOUND(p_nh%metrics% &
+    &  ddxn_z_full))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_ddxt_z_full)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%ddxt_z_full )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%ddxt_z_full", p_nh%metrics%ddxt_z_full, LBOUND(p_nh%metrics%ddxt_z_full), UBOUND(p_nh%metrics% &
+    &  ddxt_z_full))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_exner_exfac)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%exner_exfac )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%exner_exfac", p_nh%metrics%exner_exfac, LBOUND(p_nh%metrics%exner_exfac), UBOUND(p_nh%metrics% &
+    &  exner_exfac))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_exner_ref_mc)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%exner_ref_mc )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%exner_ref_mc", p_nh%metrics%exner_ref_mc, LBOUND(p_nh%metrics%exner_ref_mc), UBOUND(p_nh%metrics% &
+    &  exner_ref_mc))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_hmask_dd3d)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%hmask_dd3d )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%hmask_dd3d", p_nh%metrics%hmask_dd3d, LBOUND(p_nh%metrics%hmask_dd3d), UBOUND(p_nh%metrics% &
+    &  hmask_dd3d))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_inv_ddqz_z_full)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%inv_ddqz_z_full )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%inv_ddqz_z_full", p_nh%metrics%inv_ddqz_z_full, LBOUND(p_nh%metrics%inv_ddqz_z_full), UBOUND( &
+    &  p_nh%metrics%inv_ddqz_z_full))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_mask_prog_halo_c)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%mask_prog_halo_c )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%mask_prog_halo_c", p_nh%metrics%mask_prog_halo_c, LBOUND(p_nh%metrics%mask_prog_halo_c), UBOUND( &
+    &  p_nh%metrics%mask_prog_halo_c))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_nudge_e_blk)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%nudge_e_blk )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%nudge_e_blk", p_nh%metrics%nudge_e_blk, LBOUND(p_nh%metrics%nudge_e_blk), UBOUND(p_nh%metrics% &
+    &  nudge_e_blk))
+    CALL ftg_write("p_nh%metrics%nudge_e_dim", p_nh%metrics%nudge_e_dim)
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_nudge_e_idx)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%nudge_e_idx )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%nudge_e_idx", p_nh%metrics%nudge_e_idx, LBOUND(p_nh%metrics%nudge_e_idx), UBOUND(p_nh%metrics% &
+    &  nudge_e_idx))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_pg_edgeblk)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%pg_edgeblk )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%pg_edgeblk", p_nh%metrics%pg_edgeblk, LBOUND(p_nh%metrics%pg_edgeblk), UBOUND(p_nh%metrics% &
+    &  pg_edgeblk))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_pg_edgeidx)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%pg_edgeidx )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%pg_edgeidx", p_nh%metrics%pg_edgeidx, LBOUND(p_nh%metrics%pg_edgeidx), UBOUND(p_nh%metrics% &
+    &  pg_edgeidx))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_pg_exdist)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%pg_exdist )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%pg_exdist", p_nh%metrics%pg_exdist, LBOUND(p_nh%metrics%pg_exdist), UBOUND(p_nh%metrics%pg_exdist))
+    CALL ftg_write("p_nh%metrics%pg_listdim", p_nh%metrics%pg_listdim)
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_pg_vertidx)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%pg_vertidx )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%pg_vertidx", p_nh%metrics%pg_vertidx, LBOUND(p_nh%metrics%pg_vertidx), UBOUND(p_nh%metrics% &
+    &  pg_vertidx))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_rayleigh_vn)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%rayleigh_vn )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%rayleigh_vn", p_nh%metrics%rayleigh_vn, LBOUND(p_nh%metrics%rayleigh_vn), UBOUND(p_nh%metrics% &
+    &  rayleigh_vn))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_rayleigh_w)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%rayleigh_w )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%rayleigh_w", p_nh%metrics%rayleigh_w, LBOUND(p_nh%metrics%rayleigh_w), UBOUND(p_nh%metrics% &
+    &  rayleigh_w))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_rho_ref_mc)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%rho_ref_mc )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%rho_ref_mc", p_nh%metrics%rho_ref_mc, LBOUND(p_nh%metrics%rho_ref_mc), UBOUND(p_nh%metrics% &
+    &  rho_ref_mc))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_rho_ref_me)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%rho_ref_me )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%rho_ref_me", p_nh%metrics%rho_ref_me, LBOUND(p_nh%metrics%rho_ref_me), UBOUND(p_nh%metrics% &
+    &  rho_ref_me))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_scalfac_dd3d)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%scalfac_dd3d )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%scalfac_dd3d", p_nh%metrics%scalfac_dd3d, LBOUND(p_nh%metrics%scalfac_dd3d), UBOUND(p_nh%metrics% &
+    &  scalfac_dd3d))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_theta_ref_ic)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%theta_ref_ic )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%theta_ref_ic", p_nh%metrics%theta_ref_ic, LBOUND(p_nh%metrics%theta_ref_ic), UBOUND(p_nh%metrics% &
+    &  theta_ref_ic))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_theta_ref_mc)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%theta_ref_mc )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%theta_ref_mc", p_nh%metrics%theta_ref_mc, LBOUND(p_nh%metrics%theta_ref_mc), UBOUND(p_nh%metrics% &
+    &  theta_ref_mc))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_theta_ref_me)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%theta_ref_me )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%theta_ref_me", p_nh%metrics%theta_ref_me, LBOUND(p_nh%metrics%theta_ref_me), UBOUND(p_nh%metrics% &
+    &  theta_ref_me))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_vertidx_gradp)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%vertidx_gradp )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%vertidx_gradp", p_nh%metrics%vertidx_gradp, LBOUND(p_nh%metrics%vertidx_gradp), UBOUND(p_nh% &
+    &  metrics%vertidx_gradp))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_vwind_expl_wgt)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%vwind_expl_wgt )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%vwind_expl_wgt", p_nh%metrics%vwind_expl_wgt, LBOUND(p_nh%metrics%vwind_expl_wgt), UBOUND(p_nh% &
+    &  metrics%vwind_expl_wgt))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_vwind_impl_wgt)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%vwind_impl_wgt )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%vwind_impl_wgt", p_nh%metrics%vwind_impl_wgt, LBOUND(p_nh%metrics%vwind_impl_wgt), UBOUND(p_nh% &
+    &  metrics%vwind_impl_wgt))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_wgtfac_c)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%wgtfac_c )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%wgtfac_c", p_nh%metrics%wgtfac_c, LBOUND(p_nh%metrics%wgtfac_c), UBOUND(p_nh%metrics%wgtfac_c))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_wgtfac_e)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%wgtfac_e )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%wgtfac_e", p_nh%metrics%wgtfac_e, LBOUND(p_nh%metrics%wgtfac_e), UBOUND(p_nh%metrics%wgtfac_e))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_wgtfacq1_c)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%wgtfacq1_c )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%wgtfacq1_c", p_nh%metrics%wgtfacq1_c, LBOUND(p_nh%metrics%wgtfacq1_c), UBOUND(p_nh%metrics% &
+    &  wgtfacq1_c))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_wgtfacq_c)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%wgtfacq_c )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%wgtfacq_c", p_nh%metrics%wgtfacq_c, LBOUND(p_nh%metrics%wgtfacq_c), UBOUND(p_nh%metrics%wgtfacq_c))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_wgtfacq_e)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%wgtfacq_e )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%wgtfacq_e", p_nh%metrics%wgtfacq_e, LBOUND(p_nh%metrics%wgtfacq_e), UBOUND(p_nh%metrics%wgtfacq_e))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_metrics_zdiff_gradp)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%metrics%zdiff_gradp )
+#endif
+    
+    
+    CALL ftg_write("p_nh%metrics%zdiff_gradp", p_nh%metrics%zdiff_gradp, LBOUND(p_nh%metrics%zdiff_gradp), UBOUND(p_nh%metrics% &
+    &  zdiff_gradp))
+    ftg_c = "p_nh%prog"
+    CALL ftg_register_only(ftg_c, "TYPE(t_nh_prog)", LBOUND(p_nh%prog), UBOUND(p_nh%prog))
+    IF (ALLOCATED(p_nh%prog)) THEN
+      DO ftg_d1 = LBOUND(p_nh%prog, 1), UBOUND(p_nh%prog, 1)
+        WRITE (ftg_c,'(A,I0,A)') 'p_nh%prog(', ftg_d1, ')%exner'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_8383c5)
+        ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+        !NOACC UPDATE HOST( p_nh%prog(ftg_d1)%exner )
+#endif
+        
+        
+        CALL ftg_write(ftg_c, p_nh%prog(ftg_d1)%exner, LBOUND(p_nh%prog(ftg_d1)%exner), UBOUND(p_nh%prog(ftg_d1)%exner))
+      END DO
+    END IF
+    IF (ALLOCATED(p_nh%prog)) THEN
+      DO ftg_d1 = LBOUND(p_nh%prog, 1), UBOUND(p_nh%prog, 1)
+        WRITE (ftg_c,'(A,I0,A)') 'p_nh%prog(', ftg_d1, ')%rho'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_f69926)
+        ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+        !NOACC UPDATE HOST( p_nh%prog(ftg_d1)%rho )
+#endif
+        
+        
+        CALL ftg_write(ftg_c, p_nh%prog(ftg_d1)%rho, LBOUND(p_nh%prog(ftg_d1)%rho), UBOUND(p_nh%prog(ftg_d1)%rho))
+      END DO
+    END IF
+    IF (ALLOCATED(p_nh%prog)) THEN
+      DO ftg_d1 = LBOUND(p_nh%prog, 1), UBOUND(p_nh%prog, 1)
+        WRITE (ftg_c,'(A,I0,A)') 'p_nh%prog(', ftg_d1, ')%theta_v'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_51bd83)
+        ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+        !NOACC UPDATE HOST( p_nh%prog(ftg_d1)%theta_v )
+#endif
+        
+        
+        CALL ftg_write(ftg_c, p_nh%prog(ftg_d1)%theta_v, LBOUND(p_nh%prog(ftg_d1)%theta_v), UBOUND(p_nh%prog(ftg_d1)%theta_v))
+      END DO
+    END IF
+    IF (ALLOCATED(p_nh%prog)) THEN
+      DO ftg_d1 = LBOUND(p_nh%prog, 1), UBOUND(p_nh%prog, 1)
+        WRITE (ftg_c,'(A,I0,A)') 'p_nh%prog(', ftg_d1, ')%vn'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_fe65ce)
+        ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+        !NOACC UPDATE HOST( p_nh%prog(ftg_d1)%vn )
+#endif
+        
+        
+        CALL ftg_write(ftg_c, p_nh%prog(ftg_d1)%vn, LBOUND(p_nh%prog(ftg_d1)%vn), UBOUND(p_nh%prog(ftg_d1)%vn))
+      END DO
+    END IF
+    IF (ALLOCATED(p_nh%prog)) THEN
+      DO ftg_d1 = LBOUND(p_nh%prog, 1), UBOUND(p_nh%prog, 1)
+        WRITE (ftg_c,'(A,I0,A)') 'p_nh%prog(', ftg_d1, ')%w'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_24b5f8)
+        ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+        !NOACC UPDATE HOST( p_nh%prog(ftg_d1)%w )
+#endif
+        
+        
+        CALL ftg_write(ftg_c, p_nh%prog(ftg_d1)%w, LBOUND(p_nh%prog(ftg_d1)%w), UBOUND(p_nh%prog(ftg_d1)%w))
+      END DO
+    END IF
+    CALL ftg_register_only("p_nh%ref", "TYPE(t_nh_ref)")
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_ref_vn_ref)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%ref%vn_ref )
+#endif
+    
+    
+    CALL ftg_write("p_nh%ref%vn_ref", p_nh%ref%vn_ref, LBOUND(p_nh%ref%vn_ref), UBOUND(p_nh%ref%vn_ref))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_nh_ref_w_ref)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_nh%ref%w_ref )
+#endif
+    
+    
+    CALL ftg_write("p_nh%ref%w_ref", p_nh%ref%w_ref, LBOUND(p_nh%ref%w_ref), UBOUND(p_nh%ref%w_ref))
+    CALL ftg_register_only("p_patch", "TYPE(t_patch)")
+    CALL ftg_write("p_patch%id", p_patch%id)
+    CALL ftg_write("p_patch%n_childdom", p_patch%n_childdom)
+    CALL ftg_write("p_patch%n_patch_cells", p_patch%n_patch_cells)
+    CALL ftg_write("p_patch%n_patch_cells_g", p_patch%n_patch_cells_g)
+    CALL ftg_write("p_patch%n_patch_edges", p_patch%n_patch_edges)
+    CALL ftg_write("p_patch%n_patch_edges_g", p_patch%n_patch_edges_g)
+    CALL ftg_write("p_patch%n_patch_verts", p_patch%n_patch_verts)
+    CALL ftg_write("p_patch%n_patch_verts_g", p_patch%n_patch_verts_g)
+    CALL ftg_write("p_patch%nblks_c", p_patch%nblks_c)
+    CALL ftg_write("p_patch%nblks_e", p_patch%nblks_e)
+    CALL ftg_write("p_patch%nblks_v", p_patch%nblks_v)
+    CALL ftg_write("p_patch%nlev", p_patch%nlev)
+    CALL ftg_write("p_patch%nlevp1", p_patch%nlevp1)
+    CALL ftg_write("p_patch%nshift", p_patch%nshift)
+    CALL ftg_write("p_patch%nshift_child", p_patch%nshift_child)
+    CALL ftg_write("p_patch%nshift_total", p_patch%nshift_total)
+    CALL ftg_write("p_patch%sync_cells_not_owned", p_patch%sync_cells_not_owned)
+    CALL ftg_write("p_patch%sync_edges_not_owned", p_patch%sync_edges_not_owned)
+    CALL ftg_register_only("p_patch%cells", "TYPE(t_grid_cells)")
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_cells_area)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%cells%area )
+#endif
+    
+    
+    CALL ftg_write("p_patch%cells%area", p_patch%cells%area, LBOUND(p_patch%cells%area), UBOUND(p_patch%cells%area))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_cells_edge_blk)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%cells%edge_blk )
+#endif
+    
+    
+    CALL ftg_write("p_patch%cells%edge_blk", p_patch%cells%edge_blk, LBOUND(p_patch%cells%edge_blk), UBOUND(p_patch%cells%edge_blk))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_cells_edge_idx)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%cells%edge_idx )
+#endif
+    
+    
+    CALL ftg_write("p_patch%cells%edge_idx", p_patch%cells%edge_idx, LBOUND(p_patch%cells%edge_idx), UBOUND(p_patch%cells%edge_idx))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_cells_end_blk)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%cells%end_blk )
+#endif
+    
+    
+    CALL ftg_write("p_patch%cells%end_blk", p_patch%cells%end_blk, LBOUND(p_patch%cells%end_blk), UBOUND(p_patch%cells%end_blk))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_cells_end_block)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%cells%end_block )
+#endif
+    
+    
+    CALL ftg_write("p_patch%cells%end_block", p_patch%cells%end_block, LBOUND(p_patch%cells%end_block), UBOUND(p_patch%cells% &
+    &  end_block))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_cells_end_index)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%cells%end_index )
+#endif
+    
+    
+    CALL ftg_write("p_patch%cells%end_index", p_patch%cells%end_index, LBOUND(p_patch%cells%end_index), UBOUND(p_patch%cells% &
+    &  end_index))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_cells_neighbor_blk)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%cells%neighbor_blk )
+#endif
+    
+    
+    CALL ftg_write("p_patch%cells%neighbor_blk", p_patch%cells%neighbor_blk, LBOUND(p_patch%cells%neighbor_blk), UBOUND(p_patch% &
+    &  cells%neighbor_blk))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_cells_neighbor_idx)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%cells%neighbor_idx )
+#endif
+    
+    
+    CALL ftg_write("p_patch%cells%neighbor_idx", p_patch%cells%neighbor_idx, LBOUND(p_patch%cells%neighbor_idx), UBOUND(p_patch% &
+    &  cells%neighbor_idx))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_cells_refin_ctrl)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%cells%refin_ctrl )
+#endif
+    
+    
+    CALL ftg_write("p_patch%cells%refin_ctrl", p_patch%cells%refin_ctrl, LBOUND(p_patch%cells%refin_ctrl), UBOUND(p_patch%cells% &
+    &  refin_ctrl))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_cells_start_blk)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%cells%start_blk )
+#endif
+    
+    
+    CALL ftg_write("p_patch%cells%start_blk", p_patch%cells%start_blk, LBOUND(p_patch%cells%start_blk), UBOUND(p_patch%cells% &
+    &  start_blk))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_cells_start_block)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%cells%start_block )
+#endif
+    
+    
+    CALL ftg_write("p_patch%cells%start_block", p_patch%cells%start_block, LBOUND(p_patch%cells%start_block), UBOUND(p_patch% &
+    &  cells%start_block))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_cells_start_index)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%cells%start_index )
+#endif
+    
+    
+    CALL ftg_write("p_patch%cells%start_index", p_patch%cells%start_index, LBOUND(p_patch%cells%start_index), UBOUND(p_patch% &
+    &  cells%start_index))
+    CALL ftg_register_only("p_patch%edges", "TYPE(t_grid_edges)")
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_area_edge)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%area_edge )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%area_edge", p_patch%edges%area_edge, LBOUND(p_patch%edges%area_edge), UBOUND(p_patch%edges% &
+    &  area_edge))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_cell_blk)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%cell_blk )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%cell_blk", p_patch%edges%cell_blk, LBOUND(p_patch%edges%cell_blk), UBOUND(p_patch%edges%cell_blk))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_cell_idx)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%cell_idx )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%cell_idx", p_patch%edges%cell_idx, LBOUND(p_patch%edges%cell_idx), UBOUND(p_patch%edges%cell_idx))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_edge_cell_length)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%edge_cell_length )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%edge_cell_length", p_patch%edges%edge_cell_length, LBOUND(p_patch%edges%edge_cell_length), &
+    &  UBOUND(p_patch%edges%edge_cell_length))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_end_blk)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%end_blk )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%end_blk", p_patch%edges%end_blk, LBOUND(p_patch%edges%end_blk), UBOUND(p_patch%edges%end_blk))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_end_block)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%end_block )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%end_block", p_patch%edges%end_block, LBOUND(p_patch%edges%end_block), UBOUND(p_patch%edges% &
+    &  end_block))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_end_index)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%end_index )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%end_index", p_patch%edges%end_index, LBOUND(p_patch%edges%end_index), UBOUND(p_patch%edges% &
+    &  end_index))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_f_e)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%f_e )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%f_e", p_patch%edges%f_e, LBOUND(p_patch%edges%f_e), UBOUND(p_patch%edges%f_e))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_inv_dual_edge_length)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%inv_dual_edge_length )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%inv_dual_edge_length", p_patch%edges%inv_dual_edge_length, LBOUND(p_patch%edges% &
+    &  inv_dual_edge_length), UBOUND(p_patch%edges%inv_dual_edge_length))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_inv_primal_edge_length)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%inv_primal_edge_length )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%inv_primal_edge_length", p_patch%edges%inv_primal_edge_length, LBOUND(p_patch%edges% &
+    &  inv_primal_edge_length), UBOUND(p_patch%edges%inv_primal_edge_length))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_quad_blk)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%quad_blk )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%quad_blk", p_patch%edges%quad_blk, LBOUND(p_patch%edges%quad_blk), UBOUND(p_patch%edges%quad_blk))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_quad_idx)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%quad_idx )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%quad_idx", p_patch%edges%quad_idx, LBOUND(p_patch%edges%quad_idx), UBOUND(p_patch%edges%quad_idx))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_refin_ctrl)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%refin_ctrl )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%refin_ctrl", p_patch%edges%refin_ctrl, LBOUND(p_patch%edges%refin_ctrl), UBOUND(p_patch%edges% &
+    &  refin_ctrl))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_start_blk)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%start_blk )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%start_blk", p_patch%edges%start_blk, LBOUND(p_patch%edges%start_blk), UBOUND(p_patch%edges% &
+    &  start_blk))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_start_block)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%start_block )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%start_block", p_patch%edges%start_block, LBOUND(p_patch%edges%start_block), UBOUND(p_patch% &
+    &  edges%start_block))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_start_index)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%start_index )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%start_index", p_patch%edges%start_index, LBOUND(p_patch%edges%start_index), UBOUND(p_patch% &
+    &  edges%start_index))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_tangent_orientation)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%tangent_orientation )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%tangent_orientation", p_patch%edges%tangent_orientation, LBOUND(p_patch%edges% &
+    &  tangent_orientation), UBOUND(p_patch%edges%tangent_orientation))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_vertex_blk)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%vertex_blk )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%vertex_blk", p_patch%edges%vertex_blk, LBOUND(p_patch%edges%vertex_blk), UBOUND(p_patch%edges% &
+    &  vertex_blk))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_vertex_idx)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%vertex_idx )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%vertex_idx", p_patch%edges%vertex_idx, LBOUND(p_patch%edges%vertex_idx), UBOUND(p_patch%edges% &
+    &  vertex_idx))
+    CALL ftg_register_only("p_patch%geometry_info", "TYPE(t_grid_geometry_info)")
+    CALL ftg_write("p_patch%geometry_info%cell_type", p_patch%geometry_info%cell_type)
+    CALL ftg_write("p_patch%geometry_info%mean_cell_area", p_patch%geometry_info%mean_cell_area)
+    CALL ftg_register_only("p_patch%verts", "TYPE(t_grid_vertices)")
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_verts_cell_blk)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%verts%cell_blk )
+#endif
+    
+    
+    CALL ftg_write("p_patch%verts%cell_blk", p_patch%verts%cell_blk, LBOUND(p_patch%verts%cell_blk), UBOUND(p_patch%verts%cell_blk))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_verts_cell_idx)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%verts%cell_idx )
+#endif
+    
+    
+    CALL ftg_write("p_patch%verts%cell_idx", p_patch%verts%cell_idx, LBOUND(p_patch%verts%cell_idx), UBOUND(p_patch%verts%cell_idx))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_verts_edge_blk)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%verts%edge_blk )
+#endif
+    
+    
+    CALL ftg_write("p_patch%verts%edge_blk", p_patch%verts%edge_blk, LBOUND(p_patch%verts%edge_blk), UBOUND(p_patch%verts%edge_blk))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_verts_edge_idx)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%verts%edge_idx )
+#endif
+    
+    
+    CALL ftg_write("p_patch%verts%edge_idx", p_patch%verts%edge_idx, LBOUND(p_patch%verts%edge_idx), UBOUND(p_patch%verts%edge_idx))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_verts_end_blk)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%verts%end_blk )
+#endif
+    
+    
+    CALL ftg_write("p_patch%verts%end_blk", p_patch%verts%end_blk, LBOUND(p_patch%verts%end_blk), UBOUND(p_patch%verts%end_blk))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_verts_end_block)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%verts%end_block )
+#endif
+    
+    
+    CALL ftg_write("p_patch%verts%end_block", p_patch%verts%end_block, LBOUND(p_patch%verts%end_block), UBOUND(p_patch%verts% &
+    &  end_block))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_verts_end_index)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%verts%end_index )
+#endif
+    
+    
+    CALL ftg_write("p_patch%verts%end_index", p_patch%verts%end_index, LBOUND(p_patch%verts%end_index), UBOUND(p_patch%verts% &
+    &  end_index))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_verts_start_blk)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%verts%start_blk )
+#endif
+    
+    
+    CALL ftg_write("p_patch%verts%start_blk", p_patch%verts%start_blk, LBOUND(p_patch%verts%start_blk), UBOUND(p_patch%verts% &
+    &  start_blk))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_verts_start_block)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%verts%start_block )
+#endif
+    
+    
+    CALL ftg_write("p_patch%verts%start_block", p_patch%verts%start_block, LBOUND(p_patch%verts%start_block), UBOUND(p_patch% &
+    &  verts%start_block))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_verts_start_index)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%verts%start_index )
+#endif
+    
+    
+    CALL ftg_write("p_patch%verts%start_index", p_patch%verts%start_index, LBOUND(p_patch%verts%start_index), UBOUND(p_patch% &
+    &  verts%start_index))
+    CALL ftg_register_only("p_patch%cells%decomp_info", "TYPE(t_grid_domain_decomp_info)")
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_cells_decomp_info_decomp_domain)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%cells%decomp_info%decomp_domain )
+#endif
+    
+    
+    CALL ftg_write("p_patch%cells%decomp_info%decomp_domain", p_patch%cells%decomp_info%decomp_domain, LBOUND(p_patch%cells% &
+    &  decomp_info%decomp_domain), UBOUND(p_patch%cells%decomp_info%decomp_domain))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_cells_decomp_info_glb_index)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%cells%decomp_info%glb_index )
+#endif
+    
+    
+    CALL ftg_write("p_patch%cells%decomp_info%glb_index", p_patch%cells%decomp_info%glb_index, LBOUND(p_patch%cells%decomp_info% &
+    &  glb_index), UBOUND(p_patch%cells%decomp_info%glb_index))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_cells_decomp_info_owner_mask)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%cells%decomp_info%owner_mask )
+#endif
+    
+    
+    CALL ftg_write("p_patch%cells%decomp_info%owner_mask", p_patch%cells%decomp_info%owner_mask, LBOUND(p_patch%cells%decomp_info% &
+    &  owner_mask), UBOUND(p_patch%cells%decomp_info%owner_mask))
+    CALL ftg_register_only("p_patch%edges%decomp_info", "TYPE(t_grid_domain_decomp_info)")
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_decomp_info_decomp_domain)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%decomp_info%decomp_domain )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%decomp_info%decomp_domain", p_patch%edges%decomp_info%decomp_domain, LBOUND(p_patch%edges% &
+    &  decomp_info%decomp_domain), UBOUND(p_patch%edges%decomp_info%decomp_domain))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_decomp_info_glb_index)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%decomp_info%glb_index )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%decomp_info%glb_index", p_patch%edges%decomp_info%glb_index, LBOUND(p_patch%edges%decomp_info% &
+    &  glb_index), UBOUND(p_patch%edges%decomp_info%glb_index))
+    IF (ALLOCATED(p_patch%edges%dual_normal_cell)) THEN
+      CALL ftg_register_only("p_patch%edges%dual_normal_cell", "TYPE(t_tangent_vectors)", LBOUND(p_patch%edges%dual_normal_cell), &
+      &  UBOUND(p_patch%edges%dual_normal_cell))
+    END IF
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_dual_normal_cell_v1)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%dual_normal_cell%v1 )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%dual_normal_cell%v1", p_patch%edges%dual_normal_cell%v1, LBOUND(p_patch%edges%dual_normal_cell% &
+    &  v1), UBOUND(p_patch%edges%dual_normal_cell%v1))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_dual_normal_cell_v2)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%dual_normal_cell%v2 )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%dual_normal_cell%v2", p_patch%edges%dual_normal_cell%v2, LBOUND(p_patch%edges%dual_normal_cell% &
+    &  v2), UBOUND(p_patch%edges%dual_normal_cell%v2))
+    IF (ALLOCATED(p_patch%edges%primal_normal_cell)) THEN
+      CALL ftg_register_only("p_patch%edges%primal_normal_cell", "TYPE(t_tangent_vectors)", LBOUND(p_patch%edges% &
+      &  primal_normal_cell), UBOUND(p_patch%edges%primal_normal_cell))
+    END IF
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_primal_normal_cell_v1)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%primal_normal_cell%v1 )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%primal_normal_cell%v1", p_patch%edges%primal_normal_cell%v1, LBOUND(p_patch%edges% &
+    &  primal_normal_cell%v1), UBOUND(p_patch%edges%primal_normal_cell%v1))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_edges_primal_normal_cell_v2)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%edges%primal_normal_cell%v2 )
+#endif
+    
+    
+    CALL ftg_write("p_patch%edges%primal_normal_cell%v2", p_patch%edges%primal_normal_cell%v2, LBOUND(p_patch%edges% &
+    &  primal_normal_cell%v2), UBOUND(p_patch%edges%primal_normal_cell%v2))
+    CALL ftg_register_only("p_patch%verts%decomp_info", "TYPE(t_grid_domain_decomp_info)")
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_verts_decomp_info_decomp_domain)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%verts%decomp_info%decomp_domain )
+#endif
+    
+    
+    CALL ftg_write("p_patch%verts%decomp_info%decomp_domain", p_patch%verts%decomp_info%decomp_domain, LBOUND(p_patch%verts% &
+    &  decomp_info%decomp_domain), UBOUND(p_patch%verts%decomp_info%decomp_domain))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_p_patch_verts_decomp_info_glb_index)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( p_patch%verts%decomp_info%glb_index )
+#endif
+    
+    
+    CALL ftg_write("p_patch%verts%decomp_info%glb_index", p_patch%verts%decomp_info%glb_index, LBOUND(p_patch%verts%decomp_info% &
+    &  glb_index), UBOUND(p_patch%verts%decomp_info%glb_index))
+    CALL ftg_register_only("prep_adv", "TYPE(t_prepare_adv)")
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_prep_adv_mass_flx_ic)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( prep_adv%mass_flx_ic )
+#endif
+    
+    
+    CALL ftg_write("prep_adv%mass_flx_ic", prep_adv%mass_flx_ic, LBOUND(prep_adv%mass_flx_ic), UBOUND(prep_adv%mass_flx_ic))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_prep_adv_mass_flx_me)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( prep_adv%mass_flx_me )
+#endif
+    
+    
+    CALL ftg_write("prep_adv%mass_flx_me", prep_adv%mass_flx_me, LBOUND(prep_adv%mass_flx_me), UBOUND(prep_adv%mass_flx_me))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_prep_adv_vn_traj)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( prep_adv%vn_traj )
+#endif
+    
+    
+    CALL ftg_write("prep_adv%vn_traj", prep_adv%vn_traj, LBOUND(prep_adv%vn_traj), UBOUND(prep_adv%vn_traj))
+    
+    
+    ! GLOBALS
+    CALL ftg_write("mo_icon_comm_lib__active_comm_variables", mo_icon_comm_lib__active_comm_variables)
+    CALL ftg_write("mo_icon_comm_lib__active_recv_buffers", mo_icon_comm_lib__active_recv_buffers)
+    CALL ftg_write("mo_icon_comm_lib__active_send_buffers", mo_icon_comm_lib__active_send_buffers)
+    CALL ftg_write("mo_icon_comm_lib__buffer_comm_status", mo_icon_comm_lib__buffer_comm_status)
+    CALL ftg_write("mo_icon_comm_lib__comm_lib_is_initialized", mo_icon_comm_lib__comm_lib_is_initialized)
+    CALL ftg_write("mo_nonhydrostatic_config__divdamp_fac", mo_nonhydrostatic_config__divdamp_fac)
+    CALL ftg_write("mo_nonhydrostatic_config__divdamp_fac_o2", mo_nonhydrostatic_config__divdamp_fac_o2)
+    CALL ftg_write("mo_nonhydrostatic_config__divdamp_order", mo_nonhydrostatic_config__divdamp_order)
+    CALL ftg_write("mo_nonhydrostatic_config__divdamp_type", mo_nonhydrostatic_config__divdamp_type)
+    CALL ftg_write("mo_sync__do_sync_checks", mo_sync__do_sync_checks)
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_advection_config__eta)
+    !$ACC UPDATE HOST( mo_advection_config__eta )
+#endif
+    
+    CALL ftg_write("mo_advection_config__eta", mo_advection_config__eta, LBOUND(mo_advection_config__eta), UBOUND( &
+    &  mo_advection_config__eta))
+    CALL ftg_write("mo_gridref_config__grf_intmethod_e", mo_gridref_config__grf_intmethod_e)
+    CALL ftg_write("mo_nonhydrostatic_config__iadv_rhotheta", mo_nonhydrostatic_config__iadv_rhotheta)
+    CALL ftg_write("mo_initicon_config__iau_wgt_dyn", mo_initicon_config__iau_wgt_dyn)
+    CALL ftg_write("mo_parallel_config__icon_comm_debug", mo_parallel_config__icon_comm_debug)
+    CALL ftg_write("mo_parallel_config__icon_comm_method", mo_parallel_config__icon_comm_method)
+    CALL ftg_write("mo_dynamics_config__idiv_method", mo_dynamics_config__idiv_method)
+    CALL ftg_write("mo_nonhydrostatic_config__igradp_method", mo_nonhydrostatic_config__igradp_method)
+    CALL ftg_write("mo_initicon_config__is_iau_active", mo_initicon_config__is_iau_active)
+    CALL ftg_write("mo_nonhydrostatic_config__itime_scheme", mo_nonhydrostatic_config__itime_scheme)
+    CALL ftg_write("mo_parallel_config__itype_comm", mo_parallel_config__itype_comm)
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_nonhydrostatic_config__kstart_dd3d)
+    !$ACC UPDATE HOST( mo_nonhydrostatic_config__kstart_dd3d )
+#endif
+    
+    CALL ftg_write("mo_nonhydrostatic_config__kstart_dd3d", mo_nonhydrostatic_config__kstart_dd3d, LBOUND( &
+    &  mo_nonhydrostatic_config__kstart_dd3d), UBOUND(mo_nonhydrostatic_config__kstart_dd3d))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_nonhydrostatic_config__kstart_moist)
+    !$ACC UPDATE HOST( mo_nonhydrostatic_config__kstart_moist )
+#endif
+    
+    CALL ftg_write("mo_nonhydrostatic_config__kstart_moist", mo_nonhydrostatic_config__kstart_moist, LBOUND( &
+    &  mo_nonhydrostatic_config__kstart_moist), UBOUND(mo_nonhydrostatic_config__kstart_moist))
+    CALL ftg_write("mo_grid_config__l_limited_area", mo_grid_config__l_limited_area)
+    CALL ftg_write("mo_parallel_config__l_log_checks", mo_parallel_config__l_log_checks)
+    CALL ftg_write("mo_nonhydrostatic_config__l_open_ubc", mo_nonhydrostatic_config__l_open_ubc)
+    CALL ftg_write("mo_nonhydrostatic_config__lextra_diffu", mo_nonhydrostatic_config__lextra_diffu)
+    CALL ftg_write("mo_nonhydrostatic_config__lhdiff_rcf", mo_nonhydrostatic_config__lhdiff_rcf)
+    CALL ftg_write("mo_icon_comm_lib__log_file_id", mo_icon_comm_lib__log_file_id)
+    CALL ftg_write("mo_sync__log_unit", mo_sync__log_unit)
+    CALL ftg_write("mo_interpol_config__lsq_high_ord", mo_interpol_config__lsq_high_ord)
+    CALL ftg_write("mo_run_config__ltimer", mo_run_config__ltimer)
+    CALL ftg_write("mo_run_config__lvert_nest", mo_run_config__lvert_nest)
+    CALL ftg_write("mo_icon_comm_lib__max_active_comm_variables", mo_icon_comm_lib__max_active_comm_variables)
+    CALL ftg_write("mo_parallel_config__max_mpi_message_size", mo_parallel_config__max_mpi_message_size)
+    CALL ftg_write("mo_parallel_config__max_no_of_comm_variables", mo_parallel_config__max_no_of_comm_variables)
+    CALL ftg_write("mo_icon_comm_lib__max_send_buffer_size", mo_icon_comm_lib__max_send_buffer_size)
+    CALL ftg_write("mo_icon_comm_lib__my_work_communicator", mo_icon_comm_lib__my_work_communicator)
+    CALL ftg_write("mo_parallel_config__n_ghost_rows", mo_parallel_config__n_ghost_rows)
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_nonhydrostatic_config__ndyn_substeps_var)
+    !$ACC UPDATE HOST( mo_nonhydrostatic_config__ndyn_substeps_var )
+#endif
+    
+    CALL ftg_write("mo_nonhydrostatic_config__ndyn_substeps_var", mo_nonhydrostatic_config__ndyn_substeps_var, LBOUND( &
+    &  mo_nonhydrostatic_config__ndyn_substeps_var), UBOUND(mo_nonhydrostatic_config__ndyn_substeps_var))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_vertical_grid__nflat_gradp)
+    !$ACC UPDATE HOST( mo_vertical_grid__nflat_gradp )
+#endif
+    
+    CALL ftg_write("mo_vertical_grid__nflat_gradp", mo_vertical_grid__nflat_gradp, LBOUND(mo_vertical_grid__nflat_gradp), UBOUND( &
+    &  mo_vertical_grid__nflat_gradp))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_init_vgrid__nflatlev)
+    !$ACC UPDATE HOST( mo_init_vgrid__nflatlev )
+#endif
+    
+    CALL ftg_write("mo_init_vgrid__nflatlev", mo_init_vgrid__nflatlev, LBOUND(mo_init_vgrid__nflatlev), UBOUND( &
+    &  mo_init_vgrid__nflatlev))
+    CALL ftg_write("mo_parallel_config__nproma", mo_parallel_config__nproma)
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_vertical_grid__nrdmax)
+    !$ACC UPDATE HOST( mo_vertical_grid__nrdmax )
+#endif
+    
+    CALL ftg_write("mo_vertical_grid__nrdmax", mo_vertical_grid__nrdmax, LBOUND(mo_vertical_grid__nrdmax), UBOUND( &
+    &  mo_vertical_grid__nrdmax))
+    CALL ftg_write("mo_interpol_config__nudge_max_coeff", mo_interpol_config__nudge_max_coeff)
+    CALL ftg_write("mo_parallel_config__p_test_run", mo_parallel_config__p_test_run)
+    IF (ASSOCIATED(mo_advection_utils__ptr_delp_mc_new)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_advection_utils__ptr_delp_mc_new)
+      !$ACC UPDATE HOST( mo_advection_utils__ptr_delp_mc_new )
+#endif
+      
+      CALL ftg_write("mo_advection_utils__ptr_delp_mc_new", mo_advection_utils__ptr_delp_mc_new, LBOUND( &
+      &  mo_advection_utils__ptr_delp_mc_new), UBOUND(mo_advection_utils__ptr_delp_mc_new))
+    END IF
+    IF (ASSOCIATED(mo_advection_utils__ptr_delp_mc_now)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_advection_utils__ptr_delp_mc_now)
+      !$ACC UPDATE HOST( mo_advection_utils__ptr_delp_mc_now )
+#endif
+      
+      CALL ftg_write("mo_advection_utils__ptr_delp_mc_now", mo_advection_utils__ptr_delp_mc_now, LBOUND( &
+      &  mo_advection_utils__ptr_delp_mc_now), UBOUND(mo_advection_utils__ptr_delp_mc_now))
+    END IF
+    CALL ftg_write("mo_nonhydrostatic_config__rayleigh_type", mo_nonhydrostatic_config__rayleigh_type)
+    IF (ALLOCATED(mo_icon_comm_lib__recv_buffer)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__recv_buffer)
+      !$ACC UPDATE HOST( mo_icon_comm_lib__recv_buffer )
+#endif
+      
+      CALL ftg_write("mo_icon_comm_lib__recv_buffer", mo_icon_comm_lib__recv_buffer, LBOUND(mo_icon_comm_lib__recv_buffer), &
+      &  UBOUND(mo_icon_comm_lib__recv_buffer))
+    END IF
+    CALL ftg_write("mo_nonhydrostatic_config__rhotheta_offctr", mo_nonhydrostatic_config__rhotheta_offctr)
+    IF (ALLOCATED(mo_icon_comm_lib__send_buffer)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__send_buffer)
+      !$ACC UPDATE HOST( mo_icon_comm_lib__send_buffer )
+#endif
+      
+      CALL ftg_write("mo_icon_comm_lib__send_buffer", mo_icon_comm_lib__send_buffer, LBOUND(mo_icon_comm_lib__send_buffer), &
+      &  UBOUND(mo_icon_comm_lib__send_buffer))
+    END IF
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_advection_config__shape_func)
+    !$ACC UPDATE HOST( mo_advection_config__shape_func )
+#endif
+    
+    CALL ftg_write("mo_advection_config__shape_func", mo_advection_config__shape_func, LBOUND(mo_advection_config__shape_func), &
+    &  UBOUND(mo_advection_config__shape_func))
+    CALL ftg_write("mo_parallel_config__sync_barrier_mode", mo_parallel_config__sync_barrier_mode)
+    CALL ftg_write("mo_icon_comm_lib__this_is_mpi_sequential", mo_icon_comm_lib__this_is_mpi_sequential)
+    CALL ftg_write("mo_timer__timer_back_traj", mo_timer__timer_back_traj)
+    CALL ftg_write("mo_timer__timer_barrier", mo_timer__timer_barrier)
+    CALL ftg_write("mo_timer__timer_icon_comm_barrier_2", mo_timer__timer_icon_comm_barrier_2)
+    CALL ftg_write("mo_timer__timer_icon_comm_fillrecv", mo_timer__timer_icon_comm_fillrecv)
+    CALL ftg_write("mo_timer__timer_icon_comm_fillsend", mo_timer__timer_icon_comm_fillsend)
+    CALL ftg_write("mo_timer__timer_icon_comm_ircv", mo_timer__timer_icon_comm_ircv)
+    CALL ftg_write("mo_timer__timer_icon_comm_sync", mo_timer__timer_icon_comm_sync)
+    CALL ftg_write("mo_timer__timer_icon_comm_wait", mo_timer__timer_icon_comm_wait)
+    CALL ftg_write("mo_timer__timer_intp", mo_timer__timer_intp)
+    CALL ftg_write("mo_timer__timer_solve_nh", mo_timer__timer_solve_nh)
+    CALL ftg_write("mo_timer__timer_solve_nh_cellcomp", mo_timer__timer_solve_nh_cellcomp)
+    CALL ftg_write("mo_timer__timer_solve_nh_edgecomp", mo_timer__timer_solve_nh_edgecomp)
+    CALL ftg_write("mo_timer__timer_solve_nh_exch", mo_timer__timer_solve_nh_exch)
+    CALL ftg_write("mo_timer__timer_solve_nh_veltend", mo_timer__timer_solve_nh_veltend)
+    CALL ftg_write("mo_timer__timer_solve_nh_vimpl", mo_timer__timer_solve_nh_vimpl)
+    CALL ftg_write("mo_timer__timer_solve_nh_vnupd", mo_timer__timer_solve_nh_vnupd)
+    CALL ftg_write("mo_run_config__timers_level", mo_run_config__timers_level)
+    CALL ftg_write("mo_parallel_config__use_dycore_barrier", mo_parallel_config__use_dycore_barrier)
+    CALL ftg_write("mo_parallel_config__use_icon_comm", mo_parallel_config__use_icon_comm)
+    IF (ALLOCATED(mo_vertical_coord_table__vct_a)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_vertical_coord_table__vct_a)
+      !$ACC UPDATE HOST( mo_vertical_coord_table__vct_a )
+#endif
+      
+      CALL ftg_write("mo_vertical_coord_table__vct_a", mo_vertical_coord_table__vct_a, LBOUND(mo_vertical_coord_table__vct_a), &
+      &  UBOUND(mo_vertical_coord_table__vct_a))
+    END IF
+    CALL ftg_write("mo_nonhydrostatic_config__veladv_offctr", mo_nonhydrostatic_config__veladv_offctr)
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_advection_config__wgt_eta)
+    !$ACC UPDATE HOST( mo_advection_config__wgt_eta )
+#endif
+    
+    CALL ftg_write("mo_advection_config__wgt_eta", mo_advection_config__wgt_eta, LBOUND(mo_advection_config__wgt_eta), UBOUND( &
+    &  mo_advection_config__wgt_eta))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_advection_config__wgt_zeta)
+    !$ACC UPDATE HOST( mo_advection_config__wgt_zeta )
+#endif
+    
+    CALL ftg_write("mo_advection_config__wgt_zeta", mo_advection_config__wgt_zeta, LBOUND(mo_advection_config__wgt_zeta), UBOUND( &
+    &  mo_advection_config__wgt_zeta))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_advection_config__zeta)
+    !$ACC UPDATE HOST( mo_advection_config__zeta )
+#endif
+    
+    CALL ftg_write("mo_advection_config__zeta", mo_advection_config__zeta, LBOUND(mo_advection_config__zeta), UBOUND( &
+    &  mo_advection_config__zeta))
+    CALL ftg_register_only("mo_advection_config__advection_config", "TYPE(t_advection_config)", LBOUND( &
+    &  mo_advection_config__advection_config), UBOUND(mo_advection_config__advection_config))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_advection_config__advection_config_beta_fct)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( mo_advection_config__advection_config%beta_fct )
+#endif
+    
+    
+    CALL ftg_write("mo_advection_config__advection_config%beta_fct", mo_advection_config__advection_config%beta_fct, LBOUND( &
+    &  mo_advection_config__advection_config%beta_fct), UBOUND(mo_advection_config__advection_config%beta_fct))
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_advection_config__advection_config_llsq_svd)
+    ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+    !NOACC UPDATE HOST( mo_advection_config__advection_config%llsq_svd )
+#endif
+    
+    
+    CALL ftg_write("mo_advection_config__advection_config%llsq_svd", mo_advection_config__advection_config%llsq_svd, LBOUND( &
+    &  mo_advection_config__advection_config%llsq_svd), UBOUND(mo_advection_config__advection_config%llsq_svd))
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+      CALL ftg_register_only("mo_icon_comm_lib__comm_variable", "TYPE(t_comm_variable_real)", LBOUND( &
+      &  mo_icon_comm_lib__comm_variable), UBOUND(mo_icon_comm_lib__comm_variable))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__comm_variable_comm_buffer)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable%comm_buffer )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__comm_variable%comm_buffer", mo_icon_comm_lib__comm_variable%comm_buffer, LBOUND( &
+      &  mo_icon_comm_lib__comm_variable%comm_buffer), UBOUND(mo_icon_comm_lib__comm_variable%comm_buffer))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__comm_variable_comm_pattern_index)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable%comm_pattern_index )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__comm_variable%comm_pattern_index", mo_icon_comm_lib__comm_variable%comm_pattern_index, &
+      &  LBOUND(mo_icon_comm_lib__comm_variable%comm_pattern_index), UBOUND(mo_icon_comm_lib__comm_variable%comm_pattern_index))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__comm_variable_comm_status)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable%comm_status )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__comm_variable%comm_status", mo_icon_comm_lib__comm_variable%comm_status, LBOUND( &
+      &  mo_icon_comm_lib__comm_variable%comm_status), UBOUND(mo_icon_comm_lib__comm_variable%comm_status))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__comm_variable_dim_4)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable%dim_4 )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__comm_variable%dim_4", mo_icon_comm_lib__comm_variable%dim_4, LBOUND( &
+      &  mo_icon_comm_lib__comm_variable%dim_4), UBOUND(mo_icon_comm_lib__comm_variable%dim_4))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__comm_variable_grid_dim)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable%grid_dim )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__comm_variable%grid_dim", mo_icon_comm_lib__comm_variable%grid_dim, LBOUND( &
+      &  mo_icon_comm_lib__comm_variable%grid_dim), UBOUND(mo_icon_comm_lib__comm_variable%grid_dim))
+    END IF
+    ! *** WARNING: Type not supported by serialbox ***
+    !     mo_icon_comm_lib__comm_variable%name
+    !     CHARACTER(len=32) | dimension: 0
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__comm_variable_no_of_variables)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable%no_of_variables )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__comm_variable%no_of_variables", mo_icon_comm_lib__comm_variable%no_of_variables, LBOUND( &
+      &  mo_icon_comm_lib__comm_variable%no_of_variables), UBOUND(mo_icon_comm_lib__comm_variable%no_of_variables))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+      DO ftg_d1 = LBOUND(mo_icon_comm_lib__comm_variable, 1), UBOUND(mo_icon_comm_lib__comm_variable, 1)
+        WRITE (ftg_c,'(A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%recv_values_2d'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_a57891)
+        ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+        !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable(ftg_d1)%recv_values_2d )
+#endif
+        
+        
+        CALL ftg_write(ftg_c, mo_icon_comm_lib__comm_variable(ftg_d1)%recv_values_2d, LBOUND(mo_icon_comm_lib__comm_variable( &
+        &  ftg_d1)%recv_values_2d), UBOUND(mo_icon_comm_lib__comm_variable(ftg_d1)%recv_values_2d))
+      END DO
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+      DO ftg_d1 = LBOUND(mo_icon_comm_lib__comm_variable, 1), UBOUND(mo_icon_comm_lib__comm_variable, 1)
+        WRITE (ftg_c,'(A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%recv_values_3d'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_525c55)
+        ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+        !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable(ftg_d1)%recv_values_3d )
+#endif
+        
+        
+        CALL ftg_write(ftg_c, mo_icon_comm_lib__comm_variable(ftg_d1)%recv_values_3d, LBOUND(mo_icon_comm_lib__comm_variable( &
+        &  ftg_d1)%recv_values_3d), UBOUND(mo_icon_comm_lib__comm_variable(ftg_d1)%recv_values_3d))
+      END DO
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+      DO ftg_d1 = LBOUND(mo_icon_comm_lib__comm_variable, 1), UBOUND(mo_icon_comm_lib__comm_variable, 1)
+        WRITE (ftg_c,'(A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%recv_values_4d'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_a2084c)
+        ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+        !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable(ftg_d1)%recv_values_4d )
+#endif
+        
+        
+        CALL ftg_write(ftg_c, mo_icon_comm_lib__comm_variable(ftg_d1)%recv_values_4d, LBOUND(mo_icon_comm_lib__comm_variable( &
+        &  ftg_d1)%recv_values_4d), UBOUND(mo_icon_comm_lib__comm_variable(ftg_d1)%recv_values_4d))
+      END DO
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__comm_variable_request)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable%request )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__comm_variable%request", mo_icon_comm_lib__comm_variable%request, LBOUND( &
+      &  mo_icon_comm_lib__comm_variable%request), UBOUND(mo_icon_comm_lib__comm_variable%request))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__comm_variable_scope)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable%scope )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__comm_variable%scope", mo_icon_comm_lib__comm_variable%scope, LBOUND( &
+      &  mo_icon_comm_lib__comm_variable%scope), UBOUND(mo_icon_comm_lib__comm_variable%scope))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+      DO ftg_d1 = LBOUND(mo_icon_comm_lib__comm_variable, 1), UBOUND(mo_icon_comm_lib__comm_variable, 1)
+        WRITE (ftg_c,'(A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%send_values_2d'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_77eae8)
+        ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+        !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable(ftg_d1)%send_values_2d )
+#endif
+        
+        
+        CALL ftg_write(ftg_c, mo_icon_comm_lib__comm_variable(ftg_d1)%send_values_2d, LBOUND(mo_icon_comm_lib__comm_variable( &
+        &  ftg_d1)%send_values_2d), UBOUND(mo_icon_comm_lib__comm_variable(ftg_d1)%send_values_2d))
+      END DO
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+      DO ftg_d1 = LBOUND(mo_icon_comm_lib__comm_variable, 1), UBOUND(mo_icon_comm_lib__comm_variable, 1)
+        WRITE (ftg_c,'(A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%send_values_3d'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_9db3f8)
+        ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+        !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable(ftg_d1)%send_values_3d )
+#endif
+        
+        
+        CALL ftg_write(ftg_c, mo_icon_comm_lib__comm_variable(ftg_d1)%send_values_3d, LBOUND(mo_icon_comm_lib__comm_variable( &
+        &  ftg_d1)%send_values_3d), UBOUND(mo_icon_comm_lib__comm_variable(ftg_d1)%send_values_3d))
+      END DO
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+      DO ftg_d1 = LBOUND(mo_icon_comm_lib__comm_variable, 1), UBOUND(mo_icon_comm_lib__comm_variable, 1)
+        WRITE (ftg_c,'(A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%send_values_4d'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_e80b38)
+        ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+        !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable(ftg_d1)%send_values_4d )
+#endif
+        
+        
+        CALL ftg_write(ftg_c, mo_icon_comm_lib__comm_variable(ftg_d1)%send_values_4d, LBOUND(mo_icon_comm_lib__comm_variable( &
+        &  ftg_d1)%send_values_4d), UBOUND(mo_icon_comm_lib__comm_variable(ftg_d1)%send_values_4d))
+      END DO
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__comm_variable_status)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable%status )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__comm_variable%status", mo_icon_comm_lib__comm_variable%status, LBOUND( &
+      &  mo_icon_comm_lib__comm_variable%status), UBOUND(mo_icon_comm_lib__comm_variable%status))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__comm_variable_vertical_layers)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable%vertical_layers )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__comm_variable%vertical_layers", mo_icon_comm_lib__comm_variable%vertical_layers, LBOUND( &
+      &  mo_icon_comm_lib__comm_variable%vertical_layers), UBOUND(mo_icon_comm_lib__comm_variable%vertical_layers))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__grid_comm_pattern_list)) THEN
+      CALL ftg_register_only("mo_icon_comm_lib__grid_comm_pattern_list", "TYPE(t_grid_comm_pattern)", LBOUND( &
+      &  mo_icon_comm_lib__grid_comm_pattern_list), UBOUND(mo_icon_comm_lib__grid_comm_pattern_list))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__grid_comm_pattern_list)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__grid_comm_pattern_list_status)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__grid_comm_pattern_list%status )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__grid_comm_pattern_list%status", mo_icon_comm_lib__grid_comm_pattern_list%status, LBOUND( &
+      &  mo_icon_comm_lib__grid_comm_pattern_list%status), UBOUND(mo_icon_comm_lib__grid_comm_pattern_list%status))
+    END IF
+    CALL ftg_register_only("mo_interpol_config__lsq_high_set", "TYPE(t_lsq_set)")
+    CALL ftg_write("mo_interpol_config__lsq_high_set%dim_c", mo_interpol_config__lsq_high_set%dim_c)
+    CALL ftg_write("mo_interpol_config__lsq_high_set%dim_unk", mo_interpol_config__lsq_high_set%dim_unk)
+    IF (ALLOCATED(mo_icon_comm_lib__recv_procs_buffer)) THEN
+      CALL ftg_register_only("mo_icon_comm_lib__recv_procs_buffer", "TYPE(t_comm_process_buffer)", LBOUND( &
+      &  mo_icon_comm_lib__recv_procs_buffer), UBOUND(mo_icon_comm_lib__recv_procs_buffer))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__recv_procs_buffer)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__recv_procs_buffer_buffer_size)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__recv_procs_buffer%buffer_size )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__recv_procs_buffer%buffer_size", mo_icon_comm_lib__recv_procs_buffer%buffer_size, LBOUND( &
+      &  mo_icon_comm_lib__recv_procs_buffer%buffer_size), UBOUND(mo_icon_comm_lib__recv_procs_buffer%buffer_size))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__recv_procs_buffer)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__recv_procs_buffer_current_index)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__recv_procs_buffer%current_index )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__recv_procs_buffer%current_index", mo_icon_comm_lib__recv_procs_buffer%current_index, &
+      &  LBOUND(mo_icon_comm_lib__recv_procs_buffer%current_index), UBOUND(mo_icon_comm_lib__recv_procs_buffer%current_index))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__recv_procs_buffer)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__recv_procs_buffer_pid)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__recv_procs_buffer%pid )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__recv_procs_buffer%pid", mo_icon_comm_lib__recv_procs_buffer%pid, LBOUND( &
+      &  mo_icon_comm_lib__recv_procs_buffer%pid), UBOUND(mo_icon_comm_lib__recv_procs_buffer%pid))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__recv_procs_buffer)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__recv_procs_buffer_start_index)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__recv_procs_buffer%start_index )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__recv_procs_buffer%start_index", mo_icon_comm_lib__recv_procs_buffer%start_index, LBOUND( &
+      &  mo_icon_comm_lib__recv_procs_buffer%start_index), UBOUND(mo_icon_comm_lib__recv_procs_buffer%start_index))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__send_procs_buffer)) THEN
+      CALL ftg_register_only("mo_icon_comm_lib__send_procs_buffer", "TYPE(t_comm_process_buffer)", LBOUND( &
+      &  mo_icon_comm_lib__send_procs_buffer), UBOUND(mo_icon_comm_lib__send_procs_buffer))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__send_procs_buffer)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__send_procs_buffer_buffer_size)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__send_procs_buffer%buffer_size )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__send_procs_buffer%buffer_size", mo_icon_comm_lib__send_procs_buffer%buffer_size, LBOUND( &
+      &  mo_icon_comm_lib__send_procs_buffer%buffer_size), UBOUND(mo_icon_comm_lib__send_procs_buffer%buffer_size))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__send_procs_buffer)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__send_procs_buffer_current_index)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__send_procs_buffer%current_index )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__send_procs_buffer%current_index", mo_icon_comm_lib__send_procs_buffer%current_index, &
+      &  LBOUND(mo_icon_comm_lib__send_procs_buffer%current_index), UBOUND(mo_icon_comm_lib__send_procs_buffer%current_index))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__send_procs_buffer)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__send_procs_buffer_end_index)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__send_procs_buffer%end_index )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__send_procs_buffer%end_index", mo_icon_comm_lib__send_procs_buffer%end_index, LBOUND( &
+      &  mo_icon_comm_lib__send_procs_buffer%end_index), UBOUND(mo_icon_comm_lib__send_procs_buffer%end_index))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__send_procs_buffer)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__send_procs_buffer_pid)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__send_procs_buffer%pid )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__send_procs_buffer%pid", mo_icon_comm_lib__send_procs_buffer%pid, LBOUND( &
+      &  mo_icon_comm_lib__send_procs_buffer%pid), UBOUND(mo_icon_comm_lib__send_procs_buffer%pid))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__send_procs_buffer)) THEN
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_mo_icon_comm_lib__send_procs_buffer_start_index)
+      ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+      !NOACC UPDATE HOST( mo_icon_comm_lib__send_procs_buffer%start_index )
+#endif
+      
+      
+      CALL ftg_write("mo_icon_comm_lib__send_procs_buffer%start_index", mo_icon_comm_lib__send_procs_buffer%start_index, LBOUND( &
+      &  mo_icon_comm_lib__send_procs_buffer%start_index), UBOUND(mo_icon_comm_lib__send_procs_buffer%start_index))
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+      DO ftg_d1 = LBOUND(mo_icon_comm_lib__comm_variable, 1), UBOUND(mo_icon_comm_lib__comm_variable, 1)
+        IF (ASSOCIATED(mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern)) THEN
+          WRITE (ftg_c,'(A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%grid_comm_pattern'
+          CALL ftg_register_only(ftg_c, "TYPE(t_grid_comm_pattern)")
+          WRITE (ftg_c,'(A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%grid_comm_pattern%no_of_recv_procs'
+          CALL ftg_write(ftg_c, mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%no_of_recv_procs)
+        END IF
+      END DO
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+      DO ftg_d1 = LBOUND(mo_icon_comm_lib__comm_variable, 1), UBOUND(mo_icon_comm_lib__comm_variable, 1)
+        IF (ASSOCIATED(mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern)) THEN
+          WRITE (ftg_c,'(A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%grid_comm_pattern%no_of_send_procs'
+          CALL ftg_write(ftg_c, mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%no_of_send_procs)
+        END IF
+      END DO
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+      DO ftg_d1 = LBOUND(mo_icon_comm_lib__comm_variable, 1), UBOUND(mo_icon_comm_lib__comm_variable, 1)
+        IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+          WRITE (ftg_c,'(A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%grid_comm_pattern%recv'
+          CALL ftg_register_only(ftg_c, "TYPE(t_process_comm_pattern)", LBOUND(mo_icon_comm_lib__comm_variable(ftg_d1)% &
+          &  grid_comm_pattern%recv), UBOUND(mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv))
+        END IF
+        IF (ASSOCIATED(mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv)) THEN
+          DO ftg_d2 = LBOUND(mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv, 1), UBOUND( &
+          &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv, 1)
+            WRITE (ftg_c,'(A,I0,A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%grid_comm_pattern%recv(', ftg_d2, &
+            &  ')%block_no'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_c68ce1)
+            ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+            !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv(ftg_d2)%block_no )
+#endif
+            
+            
+            CALL ftg_write(ftg_c, mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv(ftg_d2)%block_no, LBOUND( &
+            &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv(ftg_d2)%block_no), UBOUND( &
+            &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv(ftg_d2)%block_no))
+          END DO
+        END IF
+      END DO
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+      DO ftg_d1 = LBOUND(mo_icon_comm_lib__comm_variable, 1), UBOUND(mo_icon_comm_lib__comm_variable, 1)
+        IF (ASSOCIATED(mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern)) THEN
+          IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+            WRITE (ftg_c,'(A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%grid_comm_pattern%recv%buffer_index'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_ef9557)
+            ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+            !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv%buffer_index )
+#endif
+            
+            
+            CALL ftg_write(ftg_c, mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv%buffer_index, LBOUND( &
+            &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv%buffer_index), UBOUND( &
+            &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv%buffer_index))
+          END IF
+        END IF
+      END DO
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+      DO ftg_d1 = LBOUND(mo_icon_comm_lib__comm_variable, 1), UBOUND(mo_icon_comm_lib__comm_variable, 1)
+        IF (ASSOCIATED(mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv)) THEN
+          DO ftg_d2 = LBOUND(mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv, 1), UBOUND( &
+          &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv, 1)
+            WRITE (ftg_c,'(A,I0,A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%grid_comm_pattern%recv(', ftg_d2, &
+            &  ')%index_no'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_af8093)
+            ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+            !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv(ftg_d2)%index_no )
+#endif
+            
+            
+            CALL ftg_write(ftg_c, mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv(ftg_d2)%index_no, LBOUND( &
+            &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv(ftg_d2)%index_no), UBOUND( &
+            &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv(ftg_d2)%index_no))
+          END DO
+        END IF
+      END DO
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+      DO ftg_d1 = LBOUND(mo_icon_comm_lib__comm_variable, 1), UBOUND(mo_icon_comm_lib__comm_variable, 1)
+        IF (ASSOCIATED(mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern)) THEN
+          IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+            WRITE (ftg_c,'(A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%grid_comm_pattern%recv%no_of_points'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_2ef5e6)
+            ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+            !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv%no_of_points )
+#endif
+            
+            
+            CALL ftg_write(ftg_c, mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv%no_of_points, LBOUND( &
+            &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv%no_of_points), UBOUND( &
+            &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%recv%no_of_points))
+          END IF
+        END IF
+      END DO
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+      DO ftg_d1 = LBOUND(mo_icon_comm_lib__comm_variable, 1), UBOUND(mo_icon_comm_lib__comm_variable, 1)
+        IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+          WRITE (ftg_c,'(A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%grid_comm_pattern%send'
+          CALL ftg_register_only(ftg_c, "TYPE(t_process_comm_pattern)", LBOUND(mo_icon_comm_lib__comm_variable(ftg_d1)% &
+          &  grid_comm_pattern%send), UBOUND(mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send))
+        END IF
+        IF (ASSOCIATED(mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send)) THEN
+          DO ftg_d2 = LBOUND(mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send, 1), UBOUND( &
+          &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send, 1)
+            WRITE (ftg_c,'(A,I0,A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%grid_comm_pattern%send(', ftg_d2, &
+            &  ')%block_no'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_78090e)
+            ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+            !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send(ftg_d2)%block_no )
+#endif
+            
+            
+            CALL ftg_write(ftg_c, mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send(ftg_d2)%block_no, LBOUND( &
+            &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send(ftg_d2)%block_no), UBOUND( &
+            &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send(ftg_d2)%block_no))
+          END DO
+        END IF
+      END DO
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+      DO ftg_d1 = LBOUND(mo_icon_comm_lib__comm_variable, 1), UBOUND(mo_icon_comm_lib__comm_variable, 1)
+        IF (ASSOCIATED(mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern)) THEN
+          IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+            WRITE (ftg_c,'(A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%grid_comm_pattern%send%buffer_index'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_43d846)
+            ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+            !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send%buffer_index )
+#endif
+            
+            
+            CALL ftg_write(ftg_c, mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send%buffer_index, LBOUND( &
+            &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send%buffer_index), UBOUND( &
+            &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send%buffer_index))
+          END IF
+        END IF
+      END DO
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+      DO ftg_d1 = LBOUND(mo_icon_comm_lib__comm_variable, 1), UBOUND(mo_icon_comm_lib__comm_variable, 1)
+        IF (ASSOCIATED(mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send)) THEN
+          DO ftg_d2 = LBOUND(mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send, 1), UBOUND( &
+          &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send, 1)
+            WRITE (ftg_c,'(A,I0,A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%grid_comm_pattern%send(', ftg_d2, &
+            &  ')%index_no'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_54545d)
+            ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+            !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send(ftg_d2)%index_no )
+#endif
+            
+            
+            CALL ftg_write(ftg_c, mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send(ftg_d2)%index_no, LBOUND( &
+            &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send(ftg_d2)%index_no), UBOUND( &
+            &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send(ftg_d2)%index_no))
+          END DO
+        END IF
+      END DO
+    END IF
+    IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+      DO ftg_d1 = LBOUND(mo_icon_comm_lib__comm_variable, 1), UBOUND(mo_icon_comm_lib__comm_variable, 1)
+        IF (ASSOCIATED(mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern)) THEN
+          IF (ALLOCATED(mo_icon_comm_lib__comm_variable)) THEN
+            WRITE (ftg_c,'(A,I0,A)') 'mo_icon_comm_lib__comm_variable(', ftg_d1, ')%grid_comm_pattern%send%no_of_points'
+#if defined(FTG_ACC_COPYOUT) && !defined(FTG_ACC_NOCOPYOUT_TYPE_f10645)
+            ! THIS IS CURRENTLY DISABLED AS DEALING WITH DERIVED TYPES DOES NOT WORK
+            !NOACC UPDATE HOST( mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send%no_of_points )
+#endif
+            
+            
+            CALL ftg_write(ftg_c, mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send%no_of_points, LBOUND( &
+            &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send%no_of_points), UBOUND( &
+            &  mo_icon_comm_lib__comm_variable(ftg_d1)%grid_comm_pattern%send%no_of_points))
+          END IF
+        END IF
+      END DO
+    END IF
+    
+    
+    CALL ftg_write("ftg_solve_nh_round", ftg_solve_nh_round)
+    
+    CALL ftg_destroy_savepoint()
+    WRITE (0,*) 'FTG FINALIZE output DATA solve_nh', get_my_mpi_all_id()
+    CALL ftg_destroy_serializer()
+    
+    CALL work_mpi_barrier()
+    !      CALL finish('FTG EXIT', 'Output captured: solve_nh', 0)
+    
+    CALL end_loc_timing(19)
+  END IF
+  
+END SUBROUTINE ftg_solve_nh_capture_output
+
+! ================= END FORTRAN TEST GENERATOR (FTG) =========================
+
+
+
 #ifdef _OPENACC
      SUBROUTINE h2d_solve_nonhydro( nnow, jstep, jg, idiv_method, grf_intmethod_e, lprep_adv, l_vert_nested, is_iau_active, p_nh, prep_adv )
 
